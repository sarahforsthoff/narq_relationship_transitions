---
title: "02_datawrangling"
author: "Laura Botzet, Sarah Forsthoff, Tanja Gerlach"
date: "20 April 2018"
output: html_document
---

## What to do:
Relationships:
FERTIG  (- für t2: zurückrechnen vom Datum des Ausfüllens zum Beginn der Beziehung --> Tage aus Wochen und Monaten            bestimmen und dann über as.Date zurückrechnen auf Datum des Beziehungsbeginn )
- t2: longformat
- für t2, t3: past relationships und current relationships (t3: x)
- t3: longformat (x)
- t2 & t3 mergen

Alle Informationen zu mergen

## Library
```{r}
# library(jsonlite)
# library(formr)
# library(psych)
# library(stringr)
library(mosaic)
library(tidyr)
library(dplyr)
```

## Data Import
```{r}
#setwd("C:/Users/q/Desktop/Speicherung/Arbeit/3/Narc_Relationship/narq_relationship_transitions")
#setwd("/Users/sarahforsthoff/Documents/Bachelor Arbeit/Hiwi/narq_relationship_transitions")
# set workingdirectory

pw2015_demographie =  read.csv("ImportedData/pw2015_demographie_select.csv", sep = ";")
pw2015_items = read.csv("ImportedData/pw2015_items_select.csv", sep = ";")
pw2015_t2 = read.csv("ImportedData/pw2015_t2_select.csv", sep = ";")
pw2015_t2_frauen = read.csv("ImportedData/pw2015_t2_frauen_select.csv", sep = ";")
pw2015_t2_ende = read.csv("ImportedData/pw2015_t2_ende_select.csv", sep = ";")
pw2015_t3_start = read.csv("ImportedData/pw2015_t3_start_select.csv", sep = ";")
pw2015_t3_singles = read.csv("ImportedData/pw2015_t3_start_select.csv", sep = ";")
pw2015_t3_relationship_number = read.csv("ImportedData/pw2015_t3_relationship_number_select.csv", sep = ";")
pw2015_t3_partners = read.csv("ImportedData/pw2015_t3_partners_select.csv", sep = ";")
pw2015_t3_mainrelation = read.csv("ImportedData/pw2015_t3_mainrelation_select.csv", sep = ";")
pw2015_t3_ende = read.csv("ImportedData/pw2015_t3_ende_select.csv", sep = ";")

```

## Create new data sheet
```{r}
#NARQ
pw2015_demographie[11:28] <-lapply(pw2015_demographie[11:28], as.numeric)
pw2015_demographie <- pw2015_demographie %>% rowwise () %>%  
  mutate("NARQ_ADM" = mean(c(NARQ_7, NARQ_8, NARQ_1, NARQ_18, NARQ_15, NARQ_16, NARQ_2, NARQ_5, NARQ_3),
                           na.rm = TRUE)) %>% 
  mutate("NARQ_RIV" = mean(c(NARQ_17, NARQ_11, NARQ_13, NARQ_6, NARQ_14, NARQ_9, NARQ_10, NARQ_12, NARQ_4),
                           na.rm = TRUE)) %>%
  mutate("NARQ_GESAMT" = mean(c(NARQ_7, NARQ_8, NARQ_1, NARQ_18, NARQ_15, NARQ_16, NARQ_2, NARQ_5, NARQ_3,
                                NARQ_17, NARQ_11, NARQ_13,  NARQ_6, NARQ_14, NARQ_9, NARQ_10, NARQ_12,
                                NARQ_4 ), na.rm = TRUE)) 

#SOI_R
#SOI_R-Skalenwerte erstellen
pw2015_items$SOI_R_6 <- recode(pw2015_items$SOI_R_6R, "1"= "7", "2"="6", "3"="5", "4"="4", "5"="3", "6"="2", "7"="1") #Item SOI_R_6R umpolen
pw2015_items[,c(7:15)] <- lapply(pw2015_items[,c(7:15)], as.numeric)
pw2015_items[,c("SOI_R_6")] <- lapply(pw2015_items[,c("SOI_R_6")], as.numeric)
pw2015_items <- pw2015_items %>%  #z-standardisieren, da untersch. Likert-Skalen
  mutate("z_SOI_R_5" = scale(SOI_R_5, center = TRUE, scale = TRUE),"z_SOI_R_6" = scale(SOI_R_6, center = TRUE,
                                                                                       scale = TRUE),
         "z_SOI_R_4" = scale(SOI_R_4, center = TRUE, scale = TRUE),"z_SOI_R_1" = scale(SOI_R_1, center = TRUE,
                                                                                       scale = TRUE),
         "z_SOI_R_2" = scale(SOI_R_2, center = TRUE, scale = TRUE),"z_SOI_R_3" = scale(SOI_R_3, center = TRUE,
                                                                                       scale = TRUE),
         "z_SOI_R_7" = scale(SOI_R_7, center = TRUE, scale = TRUE),"z_SOI_R_8" = scale(SOI_R_8, center = TRUE,
                                                                                       scale = TRUE),
         "z_SOI_R_8" = scale(SOI_R_8, center = TRUE, scale = TRUE),"z_SOI_R_9" = scale(SOI_R_9, center = TRUE,
                                                                                       scale = TRUE))
pw2015_items <- pw2015_items %>% 
  rowwise() %>% mutate("SOI_R_GESAMT" = mean(c(z_SOI_R_5, z_SOI_R_6, z_SOI_R_4, z_SOI_R_1, z_SOI_R_2,
                                               z_SOI_R_3, z_SOI_R_7, z_SOI_R_8, z_SOI_R_9), na.rm = TRUE))

#longterm items: scale

pw2015_items[,c(16:25)] <- lapply(pw2015_items[,c(16:25)], as.numeric)
pw2015_items$longterm_2 <- recode(pw2015_items$longterm_2_R, "1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1")
pw2015_items$longterm_4_M <- recode(pw2015_items$longterm_4_R_M, "1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1")
pw2015_items$longterm_4_F <- recode(pw2015_items$longterm_4_R_F, "1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1")
pw2015_items[,c("longterm_2", "longterm_4_M", "longterm_4_F")] <- lapply(pw2015_items[,c("longterm_2", "longterm_4_M", "longterm_4_F")], as.numeric)
pw2015_items <- pw2015_items %>%  #z-standardisieren, da untersch. Likert-Skalen
   mutate("z_longterm_1" = scale(longterm_1, center = TRUE, scale = TRUE),"z_longterm_2" = scale(longterm_2, center = TRUE, scale = TRUE),
          "z_longterm_3_M" = scale(longterm_3_M, center = TRUE, scale = TRUE),"z_longterm_3_F" = scale(longterm_3_F, center = TRUE, scale = TRUE),
          "z_longterm_4_M" = scale(longterm_4_M, center = TRUE, scale = TRUE),"z_longterm_4_F" = scale(longterm_4_F, center = TRUE, scale = TRUE),
          "z_longterm_5_M" = scale(longterm_5_M, center = TRUE, scale = TRUE),"z_longterm_5_F" = scale(longterm_5_F, center = TRUE, scale = TRUE),
          "z_longterm_6_M" = scale(longterm_6_M, center = TRUE, scale = TRUE),"z_longterm_7_F" = scale(longterm_7_F, center = TRUE, scale = TRUE))
 
#Skalenwert Long-Term Orientation
#define items
longterm_items_f <- c("z_longterm_3_F", "z_longterm_4_F", "z_longterm_5_F", "z_longterm_7_F", "z_longterm_1", "z_longterm_2")
longterm_items_m <- c("z_longterm_3_M", "z_longterm_4_M", "z_longterm_5_M", "z_longterm_6_M", "z_longterm_1", "z_longterm_2")
#aggregate to scale
pw2015_items["longterm_f"] <- rowMeans(pw2015_items[,longterm_items_f], na.rm = T)
pw2015_items["longterm_m"] <- rowMeans(pw2015_items[,longterm_items_m], na.rm = T)


#BFI items: scale
###add BFI items to raw data

###long term oriantion (dependent on sex)

```

```{r}
#create selected data sheets

#pw2015_demographie
pw2015_demographie_select <- select(pw2015_demographie, session, short_session, sex, age, sex_orientation, attracted_to, occupation, education,sex_orientation, NARQ_GESAMT, NARQ_ADM, NARQ_RIV) 

#pw2015_items
pw2015_items_select <-  select(pw2015_items, session, short_session, 
          #number_relationships, end_relationship_years, end_relationship_months, end_relationship_weeks,
          SOI_R_GESAMT, global_interest_LT, global_interest_ST,  longterm_f, longterm_m)


#pw2015_t2_relationships
pw2015_t2_relationship <- left_join(pw2015_t2, pw2015_t2_frauen, by=c("session","short_session"))
```

## Relationship information t2
T2: Relationship status 
```{r}
pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "t2_relationship" = derivedVariable(
            "0" = (relationship_f == 1 & relationship_m == 1) | (relationship_f == 1 & is.na(relationship_m) |  
                          (is.na(relationship_f) & relationship_m == 1)),
            "1" = (relationship_f == 2 | relationship_m == 2),
            "2" = (relationship_f == 3 | relationship_m == 3), .method = "first", .default = 0))


```


T2: Create start (date) variable of current relationships 
```{r}
pw2015_t2_relationship$ended.x <- as.Date(pw2015_t2_relationship$ended.x)
pw2015_t2_relationship$ended.y <- as.Date(pw2015_t2_relationship$ended.y)

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship1_start_days_m" = relationship1_start_months_m * 30 + relationship1_start_weeks_m * 7,
  "relationship1_start_m" = ended.x - relationship1_start_days_m
  )

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship1_start_days_f" = relationship1_start_months_f * 30 + relationship1_start_weeks_f * 7,
  "relationship1_start_f" = ended.y - relationship1_start_days_f
  )

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship2_start_days_m" = relationship2_start_months_m * 30 + relationship2_start_weeks_m * 7,
  "relationship2_start_m" = ended.x - relationship2_start_days_m
  )

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship2_start_days_f" = relationship2_start_months_f * 30 + relationship2_start_weeks_f * 7,
  "relationship2_start_f" = ended.y - relationship2_start_days_f
  )

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship3_start_days_m" = relationship3_start_months_m * 30 + relationship3_start_weeks_m * 7,
  "relationship3_start_m" = ended.x - relationship3_start_days_m
  )

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship3_start_days_f" = relationship3_start_months_f * 30 + relationship3_start_weeks_f * 7,
  "relationship3_start_f" = ended.y - relationship3_start_days_f
  )

#filter unnecessary start variables
pw2015_t2_relationship <- pw2015_t2_relationship %>% select(-relationship1_start_months_m, -relationship2_start_months_m,
                       -relationship3_start_months_m, -relationship1_start_weeks_m, -relationship2_start_weeks_m,    
                       -relationship3_start_weeks_m, -relationship1_start_days_m, -relationship2_start_days_m,
                       -relationship3_start_days_m, -relationship1_start_months_f, -relationship2_start_months_f,
                       -relationship3_start_months_f, -relationship1_start_weeks_f, -relationship2_start_weeks_f,    
                       -relationship3_start_weeks_f, -relationship1_start_days_f, -relationship2_start_days_f,
                       -relationship3_start_days_f)
```

##Divide current relationships depending on sex 

Relationship 1
```{r}
pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship4_kind" = derivedVariable(
     "1" = (!is.na(relationship1_kind_m) & !is.na(relationship1_kind_f)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship4_kind[pw2015_t2_relationship$relationship4_kind == 1] <- pw2015_t2_relationship$relationship1_kind_f[pw2015_t2_relationship$relationship4_kind == 1]
pw2015_t2_relationship$relationship4_kind[pw2015_t2_relationship$relationship4_kind == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship4_start" = derivedVariable(
     "1" = (!is.na(relationship1_start_m) & !is.na(relationship1_start_f)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship4_start[pw2015_t2_relationship$relationship4_start == 1] <- pw2015_t2_relationship$relationship1_start_f[pw2015_t2_relationship$relationship4_start == 1]
pw2015_t2_relationship$relationship4_start[pw2015_t2_relationship$relationship4_start == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship4_name" = derivedVariable(
     "1" = (!is.na(relationship1_m_name) & !is.na(relationship1_f_name)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship4_name[pw2015_t2_relationship$relationship4_name == 1] <- pw2015_t2_relationship$relationship1_f_name[pw2015_t2_relationship$relationship4_name == 1]
pw2015_t2_relationship$relationship4_name[pw2015_t2_relationship$relationship4_name == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship4_name_new" = derivedVariable(
     "1" = (!is.na(relationship1_name_m_new) & !is.na(relationship1_name_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship4_name_new[pw2015_t2_relationship$relationship4_name_new == 1] <- pw2015_t2_relationship$relationship1_name_f_new[pw2015_t2_relationship$relationship4_name_new == 1]
pw2015_t2_relationship$relationship4_name_new[pw2015_t2_relationship$relationship4_name_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship4_age_new" = derivedVariable(
     "1" = (!is.na(relationship1_age_m_new) & !is.na(relationship1_age_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship4_age_new[pw2015_t2_relationship$relationship4_age_new == 1] <- pw2015_t2_relationship$relationship1_age_f_new[pw2015_t2_relationship$relationship4_age_new == 1]
pw2015_t2_relationship$relationship4_age_new[pw2015_t2_relationship$relationship4_age_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship4_height_new" = derivedVariable(
     "1" = (!is.na(relationship1_height_m_new) & !is.na(relationship1_height_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship4_height_new[pw2015_t2_relationship$relationship4_height_new == 1] <- pw2015_t2_relationship$relationship1_height_f_new[pw2015_t2_relationship$relationship4_height_new == 1]
pw2015_t2_relationship$relationship4_height_new[pw2015_t2_relationship$relationship4_height_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship4_relationship_new" = derivedVariable(
     "1" = (!is.na(relationship1_relationship_m_new) & !is.na(relationship1_relationship_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship4_relationship_new[pw2015_t2_relationship$relationship4_relationship_new == 1] <- pw2015_t2_relationship$relationship1_relationship_f_new[pw2015_t2_relationship$relationship4_relationship_new == 1]
pw2015_t2_relationship$relationship4_relationship_new[pw2015_t2_relationship$relationship4_relationship_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship4_duration_new" = derivedVariable(
     "1" = (!is.na(relationship1_duration_m_new) & !is.na(relationship1_duration_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship4_duration_new[pw2015_t2_relationship$relationship4_duration_new == 1] <- pw2015_t2_relationship$relationship1_duration_f_new[pw2015_t2_relationship$relationship4_duration_new == 1]
pw2015_t2_relationship$relationship4_duration_new[pw2015_t2_relationship$relationship4_duration_new == 0] <- NA

##not necessary? -> created additional start variable
#pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
 # "relationship4_start_months" = derivedVariable(
  #   "1" = (!is.na(relationship1_start_months_m) & !is.na(relationship1_start_months_f)) ,.method = "first", .default = 0))
#pw2015_t2_relationship$relationship4_start_months[pw2015_t2_relationship$relationship4_start_months == 1] <- #pw2015_t2_relationship$relationship1_start_months_f[pw2015_t2_relationship$relationship4_start_months == 1]
#pw2015_t2_relationship$relationship4_start_months[pw2015_t2_relationship$relationship4_start_months == 0] <- NA

##not necessary? -> created additional start variable
#pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
 # "relationship4_start_weeks" = derivedVariable(
  #   "1" = (!is.na(relationship1_start_weeks_m) & !is.na(relationship1_start_weeks_f)),.method = "first", .default = 0))
#pw2015_t2_relationship$relationship4_start_weeks[pw2015_t2_relationship$relationship4_start_weeks == 1] <- #pw2015_t2_relationship$relationship1_start_weeks_f[pw2015_t2_relationship$relationship4_start_weeks == 1]
#pw2015_t2_relationship$relationship4_start_weeks[pw2015_t2_relationship$relationship4_start_weeks == 0] <- NA
```

Relationship 2
```{r}
pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship5_kind" = derivedVariable(
     "1" = (!is.na(relationship2_kind_m) & !is.na(relationship2_kind_f)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship5_kind[pw2015_t2_relationship$relationship5_kind == 1] <- pw2015_t2_relationship$relationship2_kind_f[pw2015_t2_relationship$relationship5_kind == 1]
pw2015_t2_relationship$relationship5_kind[pw2015_t2_relationship$relationship5_kind == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship5_start" = derivedVariable(
     "1" = (!is.na(relationship2_start_m) & !is.na(relationship2_start_f)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship5_start[pw2015_t2_relationship$relationship5_start == 1] <- pw2015_t2_relationship$relationship2_start_f[pw2015_t2_relationship$relationship5_start == 1]
pw2015_t2_relationship$relationship5_start[pw2015_t2_relationship$relationship5_start == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship5_name" = derivedVariable(
     "1" = (!is.na(relationship2_m_name) & !is.na(relationship2_f_name)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship5_name[pw2015_t2_relationship$relationship5_name == 1] <- pw2015_t2_relationship$relationship2_f_name[pw2015_t2_relationship$relationship5_name == 1]
pw2015_t2_relationship$relationship5_name[pw2015_t2_relationship$relationship2_name == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship5_name_new" = derivedVariable(
     "1" = (!is.na(relationship2_name_m_new) & !is.na(relationship2_name_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship5_name_new[pw2015_t2_relationship$relationship5_name_new == 1] <- pw2015_t2_relationship$relationship2_name_f_new[pw2015_t2_relationship$relationship5_name_new == 1]
pw2015_t2_relationship$relationship5_name_new[pw2015_t2_relationship$relationship5_name_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship5_age_new" = derivedVariable(
     "1" = (!is.na(relationship2_age_m_new) & !is.na(relationship2_age_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship5_age_new[pw2015_t2_relationship$relationship5_age_new == 1] <- pw2015_t2_relationship$relationship2_age_f_new[pw2015_t2_relationship$relationship5_age_new == 1]
pw2015_t2_relationship$relationship5_age_new[pw2015_t2_relationship$relationship5_age_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship5_height_new" = derivedVariable(
     "1" = (!is.na(relationship2_height_m_new) & !is.na(relationship2_height_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship4_height_new[pw2015_t2_relationship$relationship5_height_new == 1] <- pw2015_t2_relationship$relationship2_height_f_new[pw2015_t2_relationship$relationship5_height_new == 1]
pw2015_t2_relationship$relationship5_height_new[pw2015_t2_relationship$relationship5_height_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship5_relationship_new" = derivedVariable(
     "1" = (!is.na(relationship2_relationship_m_new) & !is.na(relationship2_relationship_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship5_relationship_new[pw2015_t2_relationship$relationship5_relationship_new == 1] <- pw2015_t2_relationship$relationship2_relationship_f_new[pw2015_t2_relationship$relationship5_relationship_new == 1]
pw2015_t2_relationship$relationship5_relationship_new[pw2015_t2_relationship$relationship5_relationship_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship5_duration_new" = derivedVariable(
     "1" = (!is.na(relationship2_duration_m_new) & !is.na(relationship2_duration_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship5_duration_new[pw2015_t2_relationship$relationship5_duration_new == 1] <- pw2015_t2_relationship$relationship2_duration_f_new[pw2015_t2_relationship$relationship5_duration_new == 1]
pw2015_t2_relationship$relationship5_duration_new[pw2015_t2_relationship$relationship5_duration_new == 0] <- NA

##not necessary? -> created additional start variable
#pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
 # "relationship5_start_months" = derivedVariable(
  #   "1" = (!is.na(relationship2_start_months_m) & !is.na(relationship2_start_months_f)) ,.method = "first", .default = 0))
#pw2015_t2_relationship$relationship5_start_months[pw2015_t2_relationship$relationship5_start_months == 1] <- #pw2015_t2_relationship$relationship2_start_months_f[pw2015_t2_relationship$relationship5_start_months == 1]
#pw2015_t2_relationship$relationship5_start_months[pw2015_t2_relationship$relationship5_start_months == 0] <- NA

##not necessary? -> created additional start variable
#pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
 # "relationship5_start_weeks" = derivedVariable(
  #   "1" = (!is.na(relationship2_start_weeks_m) & !is.na(relationship2_start_weeks_f)),.method = "first", .default = 0))
#pw2015_t2_relationship$relationship5_start_weeks[pw2015_t2_relationship$relationship5_start_weeks == 1] <- #pw2015_t2_relationship$relationship2_start_weeks_f[pw2015_t2_relationship$relationship5_start_weeks == 1]
#pw2015_t2_relationship$relationship5_start_weeks[pw2015_t2_relationship$relationship5_start_weeks == 0] <- NA
```

Relationship 3
```{r}
pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship6_kind" = derivedVariable(
     "1" = (!is.na(relationship3_kind_m) & !is.na(relationship3_kind_f)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship6_kind[pw2015_t2_relationship$relationship6_kind == 1] <- pw2015_t2_relationship$relationship3_kind_f[pw2015_t2_relationship$relationship6_kind == 1]
pw2015_t2_relationship$relationship6_kind[pw2015_t2_relationship$relationship6_kind == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship6_start" = derivedVariable(
     "1" = (!is.na(relationship3_start_m) & !is.na(relationship3_start_f)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship6_start[pw2015_t2_relationship$relationship6_start == 1] <- pw2015_t2_relationship$relationship3_start_f[pw2015_t2_relationship$relationship6_start == 1]
pw2015_t2_relationship$relationship6_start[pw2015_t2_relationship$relationship6_start == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship6_name" = derivedVariable(
     "1" = (!is.na(relationship3_m_name) & !is.na(relationship3_f_name)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship6_name[pw2015_t2_relationship$relationship6_name == 1] <- pw2015_t2_relationship$relationship3_f_name[pw2015_t2_relationship$relationship6_name == 1]
pw2015_t2_relationship$relationship6_name[pw2015_t2_relationship$relationship3_name == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship6_name_new" = derivedVariable(
     "1" = (!is.na(relationship3_name_m_new) & !is.na(relationship3_name_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship6_name_new[pw2015_t2_relationship$relationship6_name_new == 1] <- pw2015_t2_relationship$relationship3_name_f_new[pw2015_t2_relationship$relationship6_name_new == 1]
pw2015_t2_relationship$relationship6_name_new[pw2015_t2_relationship$relationship6_name_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship6_age_new" = derivedVariable(
     "1" = (!is.na(relationship3_age_m_new) & !is.na(relationship3_age_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship6_age_new[pw2015_t2_relationship$relationship6_age_new == 1] <- pw2015_t2_relationship$relationship3_age_f_new[pw2015_t2_relationship$relationship6_age_new == 1]
pw2015_t2_relationship$relationship6_age_new[pw2015_t2_relationship$relationship6_age_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship6_height_new" = derivedVariable(
     "1" = (!is.na(relationship3_height_m_new) & !is.na(relationship3_height_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship6_height_new[pw2015_t2_relationship$relationship6_height_new == 1] <- pw2015_t2_relationship$relationship3_height_f_new[pw2015_t2_relationship$relationship6_height_new == 1]
pw2015_t2_relationship$relationship6_height_new[pw2015_t2_relationship$relationship6_height_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship6_relationship_new" = derivedVariable(
     "1" = (!is.na(relationship3_relationship_m_new) & !is.na(relationship3_relationship_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship6_relationship_new[pw2015_t2_relationship$relationship6_relationship_new == 1] <- pw2015_t2_relationship$relationship3_relationship_f_new[pw2015_t2_relationship$relationship6_relationship_new == 1]
pw2015_t2_relationship$relationship6_relationship_new[pw2015_t2_relationship$relationship6_relationship_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship6_duration_new" = derivedVariable(
     "1" = (!is.na(relationship3_duration_m_new) & !is.na(relationship3_duration_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$relationship6_duration_new[pw2015_t2_relationship$relationship6_duration_new == 1] <- pw2015_t2_relationship$relationship3_duration_f_new[pw2015_t2_relationship$relationship6_duration_new == 1]
pw2015_t2_relationship$relationship6_duration_new[pw2015_t2_relationship$relationship6_duration_new == 0] <- NA

##not necessary? -> created additional start variable
#pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
 # "relationship6_start_months" = derivedVariable(
  #   "1" = (!is.na(relationship3_start_months_m) & !is.na(relationship3_start_months_f)) ,.method = "first", .default = 0))
#pw2015_t2_relationship$relationship6_start_months[pw2015_t2_relationship$relationship6_start_months == 1] <- #pw2015_t2_relationship$relationship3_start_months_f[pw2015_t2_relationship$relationship6_start_months == 1]
#pw2015_t2_relationship$relationship6_start_months[pw2015_t2_relationship$relationship6_start_months == 0] <- NA

##not necessary? -> created additional start variable
#pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
 # "relationship6_start_weeks" = derivedVariable(
  #   "1" = (!is.na(relationship1_start_weeks_m) & !is.na(relationship1_start_weeks_f)),.method = "first", .default = 0))
#pw2015_t2_relationship$relationship6_start_weeks[pw2015_t2_relationship$relationship6_start_weeks == 1] <- #pw2015_t2_relationship$relationship3_start_weeks_f[pw2015_t2_relationship$relationship6_start_weeks == 1]
#pw2015_t2_relationship$relationship6_start_weeks[pw2015_t2_relationship$relationship6_start_weeks == 0] <- NA
```


Unite Variables
```{r}
pw2015_t2_relationship <- pw2015_t2_relationship %>% unite(t2_relationship_multiple, relationship_m_multiple, relationship_f_multiple)


#Relationship 1
pw2015_t2_relationship <- pw2015_t2_relationship %>% unite(relationship1_kind, relationship1_kind_m, relationship1_kind_f) %>%
      unite(relationship1_start, relationship1_start_m, relationship1_start_f) %>% 
      unite(relationship1_name, relationship1_m_name, relationship1_f_name) %>% 
      unite(relationship1_name_new, relationship1_name_m_new, relationship1_name_f_new) %>% 
      unite(relationship1_age_new, relationship1_age_m_new, relationship1_age_f_new) %>% 
      unite(relationship1_height_new, relationship1_height_m_new, relationship1_height_f_new) %>%
      unite(relationship1_relationship_new, relationship1_relationship_m_new, relationship1_relationship_f_new) %>%
      unite(relationship1_duration_new, relationship1_duration_m_new, relationship1_duration_f_new)

#Relationship 2
pw2015_t2_relationship <- pw2015_t2_relationship %>% unite(relationship2_kind, relationship2_kind_m, relationship2_kind_f) %>%
      unite(relationship2_start, relationship2_start_m, relationship2_start_f) %>% 
      unite(relationship2_name, relationship2_m_name, relationship2_f_name) %>% 
      unite(relationship2_name_new, relationship2_name_m_new, relationship2_name_f_new) %>% 
      unite(relationship2_age_new, relationship2_age_m_new, relationship2_age_f_new) %>% 
      unite(relationship2_height_new, relationship2_height_m_new, relationship2_height_f_new) %>%
      unite(relationship2_relationship_new, relationship2_relationship_m_new, relationship2_relationship_f_new) %>%
      unite(relationship2_duration_new, relationship2_duration_m_new, relationship2_duration_f_new)

#Relationship 3
pw2015_t2_relationship <- pw2015_t2_relationship %>% unite(relationship3_kind, relationship3_kind_m, relationship3_kind_f) %>%
      unite(relationship3_start, relationship3_start_m, relationship3_start_f) %>% 
      unite(relationship3_name, relationship3_m_name, relationship3_f_name) %>% 
      unite(relationship3_name_new, relationship3_name_m_new, relationship3_name_f_new) %>% 
      unite(relationship3_age_new, relationship3_age_m_new, relationship3_age_f_new) %>% 
      unite(relationship3_height_new, relationship3_height_m_new, relationship3_height_f_new) %>%
      unite(relationship3_relationship_new, relationship3_relationship_m_new, relationship3_relationship_f_new) %>%
      unite(relationship3_duration_new, relationship3_duration_m_new, relationship3_duration_f_new) 

```

Divide variables, necessary when VPs had both male and female partners

Relationship 1
```{r}

pw2015_t2_relationship$relationship1_kind <- sub('_NA*','', pw2015_t2_relationship$relationship1_kind)
pw2015_t2_relationship$relationship1_kind <- sub('NA_*','', pw2015_t2_relationship$relationship1_kind)
pw2015_t2_relationship$relationship1_kind[pw2015_t2_relationship$relationship1_kind==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship1_kind)) %>% separate(relationship1_kind, c("relationship1_kind","relationship4_kind"), sep = "_")

pw2015_t2_relationship$relationship1_start <- sub('_NA*','', pw2015_t2_relationship$relationship1_start)
pw2015_t2_relationship$relationship1_start <- sub('NA_*','', pw2015_t2_relationship$relationship1_start)
pw2015_t2_relationship$relationship1_start[pw2015_t2_relationship$relationship1_start==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship1_start)) %>% separate(relationship1_start, c("relationship1_start","relationship4_start"), sep = "_")

pw2015_t2_relationship$relationship1_name <- sub('_NA*','', pw2015_t2_relationship$relationship1_name)
pw2015_t2_relationship$relationship1_name <- sub('NA_*','', pw2015_t2_relationship$relationship1_name)
pw2015_t2_relationship$relationship1_name[pw2015_t2_relationship$relationship1_name==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship1_name)) %>% separate(relationship1_name, c("relationship1_name","relationship4_name"), sep = "_")

pw2015_t2_relationship$relationship1_name_new <- sub('_NA*','', pw2015_t2_relationship$relationship1_name_new)
pw2015_t2_relationship$relationship1_name_new <- sub('NA_*','', pw2015_t2_relationship$relationship1_name_new)
pw2015_t2_relationship$relationship1_name_new[pw2015_t2_relationship$relationship1_name_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship1_name_new)) %>% separate(relationship1_name_new, c("relationship1_name_new","relationship4_name_new"), sep = "_")

pw2015_t2_relationship$relationship1_age_new <- sub('_NA*','', pw2015_t2_relationship$relationship1_age_new)
pw2015_t2_relationship$relationship1_age_new <- sub('NA_*','', pw2015_t2_relationship$relationship1_age_new)
pw2015_t2_relationship$relationship1_age_new[pw2015_t2_relationship$relationship1_age_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship1_age_new)) %>% separate(relationship1_age_new, c("relationship1_age_new","relationship4_age_new"), sep = "_")

pw2015_t2_relationship$relationship1_height_new <- sub('_NA*','', pw2015_t2_relationship$relationship1_height_new)
pw2015_t2_relationship$relationship1_height_new <- sub('NA_*','', pw2015_t2_relationship$relationship1_height_new)
pw2015_t2_relationship$relationship1_height_new[pw2015_t2_relationship$relationship1_height_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship1_height_new)) %>% separate(relationship1_height_new, c("relationship1_height_new","relationship4_height_new"), sep = "_")

pw2015_t2_relationship$relationship1_relationship_new <- sub('_NA*','', pw2015_t2_relationship$relationship1_relationship_new)
pw2015_t2_relationship$relationship1_relationship_new <- sub('NA_*','', pw2015_t2_relationship$relationship1_relationship_new)
pw2015_t2_relationship$relationship1_relationship_new[pw2015_t2_relationship$relationship1_relationship_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship1_relationship_new)) %>% separate(relationship1_relationship_new, c("relationship1_relationship_new","relationship4_relationship_new"), sep = "_")

pw2015_t2_relationship$relationship1_duration_new <- sub('_NA*','', pw2015_t2_relationship$relationship1_duration_new)
pw2015_t2_relationship$relationship1_duration_new <- sub('NA_*','', pw2015_t2_relationship$relationship1_duration_new)
pw2015_t2_relationship$relationship1_duration_new[pw2015_t2_relationship$relationship1_duration_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship1_duration_new)) %>% separate(relationship1_duration_new, c("relationship1_duration_new","relationship4_duration_new"), sep = "_")
```

Relationship 2
```{r}
pw2015_t2_relationship$relationship2_kind <- sub('_NA*','', pw2015_t2_relationship$relationship2_kind)
pw2015_t2_relationship$relationship2_kind <- sub('NA_*','', pw2015_t2_relationship$relationship2_kind)
pw2015_t2_relationship$relationship2_kind[pw2015_t2_relationship$relationship2_kind==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship2_kind)) %>% separate(relationship2_kind, c("relationship2_kind","relationship5_kind"), sep = "_")

pw2015_t2_relationship$relationship2_start <- sub('_NA*','', pw2015_t2_relationship$relationship2_start)
pw2015_t2_relationship$relationship2_start <- sub('NA_*','', pw2015_t2_relationship$relationship2_start)
pw2015_t2_relationship$relationship2_start[pw2015_t2_relationship$relationship2_start==""]  <- NA 
z <- pw2015_t2_relationship %>% group_by(grepl('_', relationship2_start)) %>% separate(relationship2_start, c("relationship2_start","relationship5_start"), sep = "_")

pw2015_t2_relationship$relationship2_name <- sub('_NA*','', pw2015_t2_relationship$relationship2_name)
pw2015_t2_relationship$relationship2_name <- sub('NA_*','', pw2015_t2_relationship$relationship2_name)
pw2015_t2_relationship$relationship2_name[pw2015_t2_relationship$relationship2_name==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship2_name)) %>% separate(relationship2_name, c("relationship2_name","relationship5_name"), sep = "_")

pw2015_t2_relationship$relationship2_name_new <- sub('_NA*','', pw2015_t2_relationship$relationship2_name_new)
pw2015_t2_relationship$relationship2_name_new <- sub('NA_*','', pw2015_t2_relationship$relationship2_name_new)
pw2015_t2_relationship$relationship2_name_new[pw2015_t2_relationship$relationship2_name_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship2_name_new)) %>% separate(relationship2_name_new, c("relationship2_name_new","relationship5_name_new"), sep = "_")

pw2015_t2_relationship$relationship2_age_new <- sub('_NA*','', pw2015_t2_relationship$relationship2_age_new)
pw2015_t2_relationship$relationship2_age_new <- sub('NA_*','', pw2015_t2_relationship$relationship2_age_new)
pw2015_t2_relationship$relationship2_age_new[pw2015_t2_relationship$relationship2_age_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship2_age_new)) %>% separate(relationship2_age_new, c("relationship2_age_new","relationship5_age_new"), sep = "_")

pw2015_t2_relationship$relationship2_height_new <- sub('_NA*','', pw2015_t2_relationship$relationship2_height_new)
pw2015_t2_relationship$relationship2_height_new <- sub('NA_*','', pw2015_t2_relationship$relationship2_height_new)
pw2015_t2_relationship$relationship2_height_new[pw2015_t2_relationship$relationship2_height_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship2_height_new)) %>% separate(relationship2_height_new, c("relationship2_height_new","relationship5_height_new"), sep = "_")

pw2015_t2_relationship$relationship2_relationship_new <- sub('_NA*','', pw2015_t2_relationship$relationship2_relationship_new)
pw2015_t2_relationship$relationship2_relationship_new <- sub('NA_*','', pw2015_t2_relationship$relationship2_relationship_new)
pw2015_t2_relationship$relationship2_relationship_new[pw2015_t2_relationship$relationship2_relationship_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship2_relationship_new)) %>% separate(relationship2_relationship_new, c("relationship2_relationship_new","relationship5_relationship_new"), sep = "_")

pw2015_t2_relationship$relationship2_duration_new <- sub('_NA*','', pw2015_t2_relationship$relationship2_duration_new)
pw2015_t2_relationship$relationship2_duration_new <- sub('NA_*','', pw2015_t2_relationship$relationship2_duration_new)
pw2015_t2_relationship$relationship2_duration_new[pw2015_t2_relationship$relationship2_duration_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship2_duration_new)) %>% separate(relationship2_duration_new, c("relationship2_duration_new","relationship5_duration_new"), sep = "_")
```

Relationship 3
```{r}
pw2015_t2_relationship$relationship3_kind <- sub('_NA*','', pw2015_t2_relationship$relationship3_kind)
pw2015_t2_relationship$relationship3_kind <- sub('NA_*','', pw2015_t2_relationship$relationship3_kind)
pw2015_t2_relationship$relationship3_kind[pw2015_t2_relationship$relationship3_kind==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship3_kind)) %>% separate(relationship3_kind, c("relationship3_kind","relationship6_kind"), sep = "_")

pw2015_t2_relationship$relationship3_start <- sub('_NA*','', pw2015_t2_relationship$relationship3_start)
pw2015_t2_relationship$relationship3_start <- sub('NA_*','', pw2015_t2_relationship$relationship3_start)
pw2015_t2_relationship$relationship3_start[pw2015_t2_relationship$relationship3_start==""]  <- NA 
z <- pw2015_t2_relationship %>% group_by(grepl('_', relationship3_start)) %>% separate(relationship3_start, c("relationship3_start","relationship6_start"), sep = "_")

pw2015_t2_relationship$relationship3_name <- sub('_NA*','', pw2015_t2_relationship$relationship3_name)
pw2015_t2_relationship$relationship3_name <- sub('NA_*','', pw2015_t2_relationship$relationship3_name)
pw2015_t2_relationship$relationship3_name[pw2015_t2_relationship$relationship3_name==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship3_name)) %>% separate(relationship3_name, c("relationship3_name","relationship6_name"), sep = "_")

pw2015_t2_relationship$relationship3_name_new <- sub('_NA*','', pw2015_t2_relationship$relationship3_name_new)
pw2015_t2_relationship$relationship3_name_new <- sub('NA_*','', pw2015_t2_relationship$relationship3_name_new)
pw2015_t2_relationship$relationship3_name_new[pw2015_t2_relationship$relationship3_name_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship3_name_new)) %>% separate(relationship3_name_new, c("relationship3_name_new","relationship6_name_new"), sep = "_")

pw2015_t2_relationship$relationship3_age_new <- sub('_NA*','', pw2015_t2_relationship$relationship3_age_new)
pw2015_t2_relationship$relationship3_age_new <- sub('NA_*','', pw2015_t2_relationship$relationship3_age_new)
pw2015_t2_relationship$relationship3_age_new[pw2015_t2_relationship$relationship3_age_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship3_age_new)) %>% separate(relationship3_age_new, c("relationship3_age_new","relationship6_age_new"), sep = "_")

pw2015_t2_relationship$relationship3_height_new <- sub('_NA*','', pw2015_t2_relationship$relationship3_height_new)
pw2015_t2_relationship$relationship3_height_new <- sub('NA_*','', pw2015_t2_relationship$relationship3_height_new)
pw2015_t2_relationship$relationship3_height_new[pw2015_t2_relationship$relationship3_height_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship3_height_new)) %>% separate(relationship3_height_new, c("relationship3_height_new","relationship6_height_new"), sep = "_")

pw2015_t2_relationship$relationship3_relationship_new <- sub('_NA*','', pw2015_t2_relationship$relationship3_relationship_new)
pw2015_t2_relationship$relationship3_relationship_new <- sub('NA_*','', pw2015_t2_relationship$relationship3_relationship_new)
pw2015_t2_relationship$relationship3_relationship_new[pw2015_t2_relationship$relationship3_relationship_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship3_relationship_new)) %>% separate(relationship3_relationship_new, c("relationship3_relationship_new","relationship6_relationship_new"), sep = "_")

pw2015_t2_relationship$relationship3_duration_new <- sub('_NA*','', pw2015_t2_relationship$relationship3_duration_new)
pw2015_t2_relationship$relationship3_duration_new <- sub('NA_*','', pw2015_t2_relationship$relationship3_duration_new)
pw2015_t2_relationship$relationship3_duration_new[pw2015_t2_relationship$relationship3_duration_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', relationship3_duration_new)) %>% separate(relationship3_duration_new, c("relationship3_duration_new","relationship6_duration_new"), sep = "_")
```



##Divide past relationships depending on sex

Ended relationship(s) since T1?
```{r}
#Achtung: Umgedrehte Kodierung wie bei t2_relationship!!
pw2015_t2_relationship <-  pw2015_t2_relationship %>% mutate(
  "t2_pastrelationship" = derivedFactor(
            "0" = (pastrelationship1_f == 2 & pastrelationship1_m == 2) | (pastrelationship1_f == 2 & 
                    is.na(pastrelationship1_m)) | (is.na(pastrelationship1_f) & pastrelationship1_m == 2),
            "1" = (pastrelationship1_f == 1 | pastrelationship1_m == 1), .method = "first", .default = 0))

```

Relationship 1
```{r}
pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship6_kind" = derivedVariable(
     "1" = (!is.na(pastrelationship1_kind_m) & !is.na(pastrelationship1_kind_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship6_kind[pw2015_t2_relationship$pastrelationship6_kind == 1] <- pw2015_t2_relationship$pastrelationship1_kind_f[pw2015_t2_relationship$pastrelationship6_kind == 1]
pw2015_t2_relationship$pastrelationship6_kind[pw2015_t2_relationship$pastrelationship6_kind == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship6_start" = derivedVariable(
     "1" = (!is.na(pastrelationship1_start_m) & !is.na(pastrelationship1_start_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship6_start[pw2015_t2_relationship$pastrelationship6_start == 1] <- pw2015_t2_relationship$pastrelationship1_start_f[pw2015_t2_relationship$pastrelationship6_start == 1]
pw2015_t2_relationship$pastrelationship6_start[pw2015_t2_relationship$pastrelationship6_start == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship6_end" = derivedVariable(
     "1" = (!is.na(pastrelationship1_end_m) & !is.na(pastrelationship1_end_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship6_end[pw2015_t2_relationship$pastrelationship6_end == 1] <- pw2015_t2_relationship$pastrelationship1_end_f[pw2015_t2_relationship$pastrelationship6_end == 1]
pw2015_t2_relationship$pastrelationship6_end[pw2015_t2_relationship$pastrelationship6_end == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship6_name" = derivedVariable(
     "1" = (!is.na(pastrelationship1_m_name) & !is.na(pastrelationship1_f_name)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship6_name[pw2015_t2_relationship$pastrelationship6_name == 1] <- pw2015_t2_relationship$pastrelationship1_f_name[pw2015_t2_relationship$pastrelationship6_name == 1]
pw2015_t2_relationship$pastrelationship6_name[pw2015_t2_relationship$pastrelationship6_name == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship6_name_new" = derivedVariable(
     "1" = (!is.na(pastrelationship1_name_m_new) & !is.na(pastrelationship1_name_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship6_name_new[pw2015_t2_relationship$pastrelationship6_name_new == 1] <- pw2015_t2_relationship$pastrelationship1_name_f_new[pw2015_t2_relationship$pastrelationship6_name_new == 1]
pw2015_t2_relationship$pastrelationship6_name_new[pw2015_t2_relationship$pastrelationship6_name_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship6_age_new" = derivedVariable(
     "1" = (!is.na(pastrelationship1_age_m_new) & !is.na(pastrelationship1_age_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship6_age_new[pw2015_t2_relationship$pastrelationship6_age_new == 1] <- pw2015_t2_relationship$pastrelationship1_age_f_new[pw2015_t2_relationship$pastrelationship6_age_new == 1]
pw2015_t2_relationship$pastrelationship6_age_new[pw2015_t2_relationship$pastrelationship6_age_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship6_height_new" = derivedVariable(
     "1" = (!is.na(pastrelationship1_height_m_new) & !is.na(pastrelationship1_height_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship6_height_new[pw2015_t2_relationship$pastrelationship6_height_new == 1] <- pw2015_t2_relationship$pastrelationship1_height_f_new[pw2015_t2_relationship$pastrelationship6_height_new == 1]
pw2015_t2_relationship$pastrelationship6_height_new[pw2015_t2_relationship$pastrelationship6_height_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship6_duration_new" = derivedVariable(
     "1" = (!is.na(pastrelationship1_duration_m_new) & !is.na(pastrelationship1_duration_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship6_duration_new[pw2015_t2_relationship$pastrelationship6_duration_new == 1] <- pw2015_t2_relationship$pastrelationship1_duration_f_new[pw2015_t2_relationship$pastrelationship6_duration_new == 1]
pw2015_t2_relationship$pastrelationship6_duration_new[pw2015_t2_relationship$pastrelationship6_duration_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship6_relationship_new" = derivedVariable(
     "1" = (!is.na(pastrelationship1_relationship_m_new) & !is.na(pastrelationship1_relationship_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship6_relationship_new[pw2015_t2_relationship$pastrelationship6_relationship_new == 1] <- pw2015_t2_relationship$pastrelationship1_relationship_f_new[pw2015_t2_relationship$pastrelationship6_relationship_new == 1]
pw2015_t2_relationship$pastrelationship6_relationship_new[pw2015_t2_relationship$pastrelationship6_relationship_new == 0] <- NA
```

Relationship 2
```{r}
pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship7_kind" = derivedVariable(
     "1" = (!is.na(pastrelationship2_kind_m) & !is.na(pastrelationship2_kind_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship7_kind[pw2015_t2_relationship$pastrelationship7_kind == 1] <- pw2015_t2_relationship$pastrelationship2_kind_f[pw2015_t2_relationship$pastrelationship7_kind == 1]
pw2015_t2_relationship$pastrelationship7_kind[pw2015_t2_relationship$pastrelationship7_kind == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship7_start" = derivedVariable(
     "1" = (!is.na(pastrelationship2_start_m) & !is.na(pastrelationship2_start_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship7_start[pw2015_t2_relationship$pastrelationship7_start == 1] <- pw2015_t2_relationship$pastrelationship2_start_f[pw2015_t2_relationship$pastrelationship7_start == 1]
pw2015_t2_relationship$pastrelationship7_start[pw2015_t2_relationship$pastrelationship7_start == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship7_end" = derivedVariable(
     "1" = (!is.na(pastrelationship2_end_m) & !is.na(pastrelationship2_end_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship7_end[pw2015_t2_relationship$pastrelationship7_end == 1] <- pw2015_t2_relationship$pastrelationship2_end_f[pw2015_t2_relationship$pastrelationship7_end == 1]
pw2015_t2_relationship$pastrelationship7_end[pw2015_t2_relationship$pastrelationship7_end == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship7_name" = derivedVariable(
     "1" = (!is.na(pastrelationship2_m_name) & !is.na(pastrelationship2_f_name)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship7_name[pw2015_t2_relationship$pastrelationship7_name == 1] <- pw2015_t2_relationship$pastrelationship2_f_name[pw2015_t2_relationship$pastrelationship7_name == 1]
pw2015_t2_relationship$pastrelationship7_name[pw2015_t2_relationship$pastrelationship7_name == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship7_name_new" = derivedVariable(
     "1" = (!is.na(pastrelationship2_name_m_new) & !is.na(pastrelationship2_name_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship7_name_new[pw2015_t2_relationship$pastrelationship7_name_new == 1] <- pw2015_t2_relationship$pastrelationship2_name_f_new[pw2015_t2_relationship$pastrelationship7_name_new == 1]
pw2015_t2_relationship$pastrelationship7_name_new[pw2015_t2_relationship$pastrelationship7_name_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship7_age_new" = derivedVariable(
     "1" = (!is.na(pastrelationship2_age_m_new) & !is.na(pastrelationship2_age_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship7_age_new[pw2015_t2_relationship$pastrelationship7_age_new == 1] <- pw2015_t2_relationship$pastrelationship2_age_f_new[pw2015_t2_relationship$pastrelationship7_age_new == 1]
pw2015_t2_relationship$pastrelationship7_age_new[pw2015_t2_relationship$pastrelationship7_age_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship7_height_new" = derivedVariable(
     "1" = (!is.na(pastrelationship2_height_m_new) & !is.na(pastrelationship2_height_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship7_height_new[pw2015_t2_relationship$pastrelationship7_height_new == 1] <- pw2015_t2_relationship$pastrelationship2_height_f_new[pw2015_t2_relationship$pastrelationship7_height_new == 1]
pw2015_t2_relationship$pastrelationship7_height_new[pw2015_t2_relationship$pastrelationship7_height_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship7_duration_new" = derivedVariable(
     "1" = (!is.na(pastrelationship2_duration_m_new) & !is.na(pastrelationship2_duration_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship7_duration_new[pw2015_t2_relationship$pastrelationship7_duration_new == 1] <- pw2015_t2_relationship$pastrelationship2_duration_f_new[pw2015_t2_relationship$pastrelationship7_duration_new == 1]
pw2015_t2_relationship$pastrelationship7_duration_new[pw2015_t2_relationship$pastrelationship7_duration_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship7_relationship_new" = derivedVariable(
     "1" = (!is.na(pastrelationship2_relationship_m_new) & !is.na(pastrelationship2_relationship_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship7_relationship_new[pw2015_t2_relationship$pastrelationship7_relationship_new == 1] <- pw2015_t2_relationship$pastrelationship2_relationship_f_new[pw2015_t2_relationship$pastrelationship7_relationship_new == 1]
pw2015_t2_relationship$pastrelationship7_relationship_new[pw2015_t2_relationship$pastrelationship7_relationship_new == 0] <- NA
```

Relationship 3
```{r}
pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship8_kind" = derivedVariable(
     "1" = (!is.na(pastrelationship3_kind_m) & !is.na(pastrelationship3_kind_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship8_kind[pw2015_t2_relationship$pastrelationship8_kind == 1] <- pw2015_t2_relationship$pastrelationship3_kind_f[pw2015_t2_relationship$pastrelationship8_kind == 1]
pw2015_t2_relationship$pastrelationship8_kind[pw2015_t2_relationship$pastrelationship8_kind == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship8_start" = derivedVariable(
     "1" = (!is.na(pastrelationship3_start_m) & !is.na(pastrelationship3_start_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship8_start[pw2015_t2_relationship$pastrelationship8_start == 1] <- pw2015_t2_relationship$pastrelationship3_start_f[pw2015_t2_relationship$pastrelationship8_start == 1]
pw2015_t2_relationship$pastrelationship8_start[pw2015_t2_relationship$pastrelationship8_start == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship8_end" = derivedVariable(
     "1" = (!is.na(pastrelationship3_end_m) & !is.na(pastrelationship3_end_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship8_end[pw2015_t2_relationship$pastrelationship8_end == 1] <- pw2015_t2_relationship$pastrelationship3_end_f[pw2015_t2_relationship$pastrelationship8_end == 1]
pw2015_t2_relationship$pastrelationship8_end[pw2015_t2_relationship$pastrelationship8_end == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship8_name" = derivedVariable(
     "1" = (!is.na(pastrelationship3_m_name) & !is.na(pastrelationship3_f_name)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship8_name[pw2015_t2_relationship$pastrelationship8_name == 1] <- pw2015_t2_relationship$pastrelationship3_f_name[pw2015_t2_relationship$pastrelationship8_name == 1]
pw2015_t2_relationship$pastrelationship8_name[pw2015_t2_relationship$pastrelationship8_name == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship8_name_new" = derivedVariable(
     "1" = (!is.na(pastrelationship3_name_m_new) & !is.na(pastrelationship3_name_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship8_name_new[pw2015_t2_relationship$pastrelationship8_name_new == 1] <- pw2015_t2_relationship$pastrelationship3_name_f_new[pw2015_t2_relationship$pastrelationship8_name_new == 1]
pw2015_t2_relationship$pastrelationship8_name_new[pw2015_t2_relationship$pastrelationship8_name_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship8_age_new" = derivedVariable(
     "1" = (!is.na(pastrelationship3_age_m_new) & !is.na(pastrelationship3_age_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship8_age_new[pw2015_t2_relationship$pastrelationship8_age_new == 1] <- pw2015_t2_relationship$pastrelationship3_age_f_new[pw2015_t2_relationship$pastrelationship8_age_new == 1]
pw2015_t2_relationship$pastrelationship8_age_new[pw2015_t2_relationship$pastrelationship8_age_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship8_height_new" = derivedVariable(
     "1" = (!is.na(pastrelationship3_height_m_new) & !is.na(pastrelationship3_height_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship8_height_new[pw2015_t2_relationship$pastrelationship8_height_new == 1] <- pw2015_t2_relationship$pastrelationship3_height_f_new[pw2015_t2_relationship$pastrelationship8_height_new == 1]
pw2015_t2_relationship$pastrelationship8_height_new[pw2015_t2_relationship$pastrelationship8_height_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship8_duration_new" = derivedVariable(
     "1" = (!is.na(pastrelationship3_duration_m_new) & !is.na(pastrelationship3_duration_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship8_duration_new[pw2015_t2_relationship$pastrelationship8_duration_new == 1] <- pw2015_t2_relationship$pastrelationship3_duration_f_new[pw2015_t2_relationship$pastrelationship8_duration_new == 1]
pw2015_t2_relationship$pastrelationship8_duration_new[pw2015_t2_relationship$pastrelationship8_duration_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship8_relationship_new" = derivedVariable(
     "1" = (!is.na(pastrelationship3_relationship_m_new) & !is.na(pastrelationship3_relationship_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship8_relationship_new[pw2015_t2_relationship$pastrelationship8_relationship_new == 1] <- pw2015_t2_relationship$pastrelationship3_relationship_f_new[pw2015_t2_relationship$pastrelationship8_relationship_new == 1]
pw2015_t2_relationship$pastrelationship8_relationship_new[pw2015_t2_relationship$pastrelationship8_relationship_new == 0] <- NA
```

Relationship 4
```{r}
pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship9_kind" = derivedVariable(
     "1" = (!is.na(pastrelationship4_kind_m) & !is.na(pastrelationship4_kind_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship9_kind[pw2015_t2_relationship$pastrelationship9_kind == 1] <- pw2015_t2_relationship$pastrelationship4_kind_f[pw2015_t2_relationship$pastrelationship9_kind == 1]
pw2015_t2_relationship$pastrelationship9_kind[pw2015_t2_relationship$pastrelationship9_kind == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship9_start" = derivedVariable(
     "1" = (!is.na(pastrelationship4_start_m) & !is.na(pastrelationship4_start_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship9_start[pw2015_t2_relationship$pastrelationship9_start == 1] <- pw2015_t2_relationship$pastrelationship4_start_f[pw2015_t2_relationship$pastrelationship9_start == 1]
pw2015_t2_relationship$pastrelationship9_start[pw2015_t2_relationship$pastrelationship9_start == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship9_end" = derivedVariable(
     "1" = (!is.na(pastrelationship4_end_m) & !is.na(pastrelationship4_end_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship9_end[pw2015_t2_relationship$pastrelationship9_end == 1] <- pw2015_t2_relationship$pastrelationship4_end_f[pw2015_t2_relationship$pastrelationship9_end == 1]
pw2015_t2_relationship$pastrelationship9_end[pw2015_t2_relationship$pastrelationship9_end == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship9_name" = derivedVariable(
     "1" = (!is.na(pastrelationship4_m_name) & !is.na(pastrelationship4_f_name)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship9_name[pw2015_t2_relationship$pastrelationship9_name == 1] <- pw2015_t2_relationship$pastrelationship4_f_name[pw2015_t2_relationship$pastrelationship9_name == 1]
pw2015_t2_relationship$pastrelationship9_name[pw2015_t2_relationship$pastrelationship9_name == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship9_name_new" = derivedVariable(
     "1" = (!is.na(pastrelationship4_name_m_new) & !is.na(pastrelationship4_name_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship9_name_new[pw2015_t2_relationship$pastrelationship9_name_new == 1] <- pw2015_t2_relationship$pastrelationship4_name_f_new[pw2015_t2_relationship$pastrelationship9_name_new == 1]
pw2015_t2_relationship$pastrelationship9_name_new[pw2015_t2_relationship$pastrelationship9_name_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship9_age_new" = derivedVariable(
     "1" = (!is.na(pastrelationship4_age_m_new) & !is.na(pastrelationship4_age_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship9_age_new[pw2015_t2_relationship$pastrelationship9_age_new == 1] <- pw2015_t2_relationship$pastrelationship4_age_f_new[pw2015_t2_relationship$pastrelationship9_age_new == 1]
pw2015_t2_relationship$pastrelationship9_age_new[pw2015_t2_relationship$pastrelationship9_age_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship9_height_new" = derivedVariable(
     "1" = (!is.na(pastrelationship4_height_m_new) & !is.na(pastrelationship4_height_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship9_height_new[pw2015_t2_relationship$pastrelationship9_height_new == 1] <- pw2015_t2_relationship$pastrelationship4_height_f_new[pw2015_t2_relationship$pastrelationship9_height_new == 1]
pw2015_t2_relationship$pastrelationship9_height_new[pw2015_t2_relationship$pastrelationship9_height_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship9_duration_new" = derivedVariable(
     "1" = (!is.na(pastrelationship4_duration_m_new) & !is.na(pastrelationship4_duration_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship9_duration_new[pw2015_t2_relationship$pastrelationship9_duration_new == 1] <- pw2015_t2_relationship$pastrelationship4_duration_f_new[pw2015_t2_relationship$pastrelationship9_duration_new == 1]
pw2015_t2_relationship$pastrelationship9_duration_new[pw2015_t2_relationship$pastrelationship9_duration_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship9_relationship_new" = derivedVariable(
     "1" = (!is.na(pastrelationship4_relationship_m_new) & !is.na(pastrelationship4_relationship_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship9_relationship_new[pw2015_t2_relationship$pastrelationship9_relationship_new == 1] <- pw2015_t2_relationship$pastrelationship4_relationship_f_new[pw2015_t2_relationship$pastrelationship9_relationship_new == 1]
pw2015_t2_relationship$pastrelationship9_relationship_new[pw2015_t2_relationship$pastrelationship9_relationship_new == 0] <- NA
```

Relationship 5
```{r}
pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship10_kind" = derivedVariable(
     "1" = (!is.na(pastrelationship5_kind_m) & !is.na(pastrelationship5_kind_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship10_kind[pw2015_t2_relationship$pastrelationship10_kind == 1] <- pw2015_t2_relationship$pastrelationship5_kind_f[pw2015_t2_relationship$pastrelationship10_kind == 1]
pw2015_t2_relationship$pastrelationship10_kind[pw2015_t2_relationship$pastrelationship10_kind == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship10_start" = derivedVariable(
     "1" = (!is.na(pastrelationship5_start_m) & !is.na(pastrelationship5_start_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship10_start[pw2015_t2_relationship$pastrelationship10_start == 1] <- pw2015_t2_relationship$pastrelationship5_start_f[pw2015_t2_relationship$pastrelationship10_start == 1]
pw2015_t2_relationship$pastrelationship10_start[pw2015_t2_relationship$pastrelationship10_start == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship10_end" = derivedVariable(
     "1" = (!is.na(pastrelationship5_end_m) & !is.na(pastrelationship5_end_f)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship10_end[pw2015_t2_relationship$pastrelationship10_end == 1] <- pw2015_t2_relationship$pastrelationship5_end_f[pw2015_t2_relationship$pastrelationship10_end == 1]
pw2015_t2_relationship$pastrelationship10_end[pw2015_t2_relationship$pastrelationship10_end == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship10_name" = derivedVariable(
     "1" = (!is.na(pastrelationship5_m_name) & !is.na(pastrelationship5_f_name)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship10_name[pw2015_t2_relationship$pastrelationship10_name == 1] <- pw2015_t2_relationship$pastrelationship5_f_name[pw2015_t2_relationship$pastrelationship10_name == 1]
pw2015_t2_relationship$pastrelationship10_name[pw2015_t2_relationship$pastrelationship10_name == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship10_name_new" = derivedVariable(
     "1" = (!is.na(pastrelationship5_name_m_new) & !is.na(pastrelationship5_name_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship10_name_new[pw2015_t2_relationship$pastrelationship10_name_new == 1] <- pw2015_t2_relationship$pastrelationship5_name_f_new[pw2015_t2_relationship$pastrelationship10_name_new == 1]
pw2015_t2_relationship$pastrelationship10_name_new[pw2015_t2_relationship$pastrelationship10_name_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship10_age_new" = derivedVariable(
     "1" = (!is.na(pastrelationship5_age_m_new) & !is.na(pastrelationship5_age_f_new)),.method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship10_age_new[pw2015_t2_relationship$pastrelationship10_age_new == 1] <- pw2015_t2_relationship$pastrelationship5_age_f_new[pw2015_t2_relationship$pastrelationship10_age_new == 1]
pw2015_t2_relationship$pastrelationship10_age_new[pw2015_t2_relationship$pastrelationship10_age_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship10_height_new" = derivedVariable(
     "1" = (!is.na(pastrelationship5_height_m_new) & !is.na(pastrelationship5_height_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship10_height_new[pw2015_t2_relationship$pastrelationship10_height_new == 1] <- pw2015_t2_relationship$pastrelationship5_height_f_new[pw2015_t2_relationship$pastrelationship10_height_new == 1]
pw2015_t2_relationship$pastrelationship10_height_new[pw2015_t2_relationship$pastrelationship10_height_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship10_duration_new" = derivedVariable(
     "1" = (!is.na(pastrelationship5_duration_m_new) & !is.na(pastrelationship5_duration_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship10_duration_new[pw2015_t2_relationship$pastrelationship10_duration_new == 1] <- pw2015_t2_relationship$pastrelationship5_duration_f_new[pw2015_t2_relationship$pastrelationship10_duration_new == 1]
pw2015_t2_relationship$pastrelationship10_duration_new[pw2015_t2_relationship$pastrelationship10_duration_new == 0] <- NA

pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "pastrelationship10_relationship_new" = derivedVariable(
     "1" = (!is.na(pastrelationship5_relationship_m_new) & !is.na(pastrelationship5_relationship_f_new)),
     .method = "first", .default = 0))
pw2015_t2_relationship$pastrelationship10_relationship_new[pw2015_t2_relationship$pastrelationship10_relationship_new == 1] <- pw2015_t2_relationship$pastrelationship5_relationship_f_new[pw2015_t2_relationship$pastrelationship10_relationship_new == 1]
pw2015_t2_relationship$pastrelationship10_relationship_new[pw2015_t2_relationship$pastrelationship10_relationship_new == 0] <- NA
```




Unite "pastrelationship"-variables
```{r}
#Relationship 1
pw2015_t2_relationship <- pw2015_t2_relationship %>% unite(pastrelationship1_name, pastrelationship1_m_name, pastrelationship1_f_name) %>%
      unite(pastrelationship1_name_new, pastrelationship1_name_m_new, pastrelationship1_name_f_new) %>% 
      unite(pastrelationship1_age_new, pastrelationship1_age_m_new, pastrelationship1_age_f_new) %>% 
      unite(pastrelationship1_height_new, pastrelationship1_height_m_new, pastrelationship1_height_f_new) %>% 
      unite(pastrelationship1_relationship_new, pastrelationship1_relationship_m_new, pastrelationship1_relationship_f_new) %>% 
      unite(pastrelationship1_duration_new, pastrelationship1_duration_m_new, pastrelationship1_duration_f_new) %>%
      unite(pastrelationship1_kind, pastrelationship1_kind_m, pastrelationship1_kind_f) %>%
      unite(pastrelationship1_start, pastrelationship1_start_m, pastrelationship1_start_f) %>%
      unite(pastrelationship1_end, pastrelationship1_end_m, pastrelationship1_end_f)

#Relationship 2
pw2015_t2_relationship <- pw2015_t2_relationship %>% unite(pastrelationship2_name, pastrelationship2_m_name, pastrelationship2_f_name) %>%
      unite(pastrelationship2_name_new, pastrelationship2_name_m_new, pastrelationship2_name_f_new) %>% 
      unite(pastrelationship2_age_new, pastrelationship2_age_m_new, pastrelationship2_age_f_new) %>% 
      unite(pastrelationship2_height_new, pastrelationship2_height_m_new, pastrelationship2_height_f_new) %>% 
      unite(pastrelationship2_relationship_new, pastrelationship2_relationship_m_new, pastrelationship2_relationship_f_new) %>% 
      unite(pastrelationship2_duration_new, pastrelationship2_duration_m_new, pastrelationship2_duration_f_new) %>%
      unite(pastrelationship2_kind, pastrelationship2_kind_m, pastrelationship2_kind_f) %>%
      unite(pastrelationship2_start, pastrelationship2_start_m, pastrelationship2_start_f) %>%
      unite(pastrelationship2_end, pastrelationship2_end_m, pastrelationship2_end_f)

#Relationship 3
pw2015_t2_relationship <- pw2015_t2_relationship %>% unite(pastrelationship3_name, pastrelationship3_m_name, pastrelationship3_f_name) %>%
      unite(pastrelationship3_name_new, pastrelationship3_name_m_new, pastrelationship3_name_f_new) %>% 
      unite(pastrelationship3_age_new, pastrelationship3_age_m_new, pastrelationship3_age_f_new) %>% 
      unite(pastrelationship3_height_new, pastrelationship3_height_m_new, pastrelationship3_height_f_new) %>% 
      unite(pastrelationship3_relationship_new, pastrelationship3_relationship_m_new, pastrelationship3_relationship_f_new) %>% 
      unite(pastrelationship3_duration_new, pastrelationship3_duration_m_new, pastrelationship3_duration_f_new) %>%
      unite(pastrelationship3_kind, pastrelationship3_kind_m, pastrelationship3_kind_f) %>%
      unite(pastrelationship3_start, pastrelationship3_start_m, pastrelationship3_start_f) %>%
      unite(pastrelationship3_end, pastrelationship3_end_m, pastrelationship3_end_f)

#Relationship 4
pw2015_t2_relationship <- pw2015_t2_relationship %>% unite(pastrelationship4_name, pastrelationship4_m_name, pastrelationship4_f_name) %>%
      unite(pastrelationship4_name_new, pastrelationship4_name_m_new, pastrelationship4_name_f_new) %>% 
      unite(pastrelationship4_age_new, pastrelationship4_age_m_new, pastrelationship4_age_f_new) %>% 
      unite(pastrelationship4_height_new, pastrelationship4_height_m_new, pastrelationship4_height_f_new) %>% 
      unite(pastrelationship4_relationship_new, pastrelationship4_relationship_m_new, pastrelationship4_relationship_f_new) %>% 
      unite(pastrelationship4_duration_new, pastrelationship4_duration_m_new, pastrelationship4_duration_f_new) %>%
      unite(pastrelationship4_kind, pastrelationship4_kind_m, pastrelationship4_kind_f) %>%
      unite(pastrelationship4_start, pastrelationship4_start_m, pastrelationship4_start_f) %>%
      unite(pastrelationship4_end, pastrelationship4_end_m, pastrelationship4_end_f)

#Relationship 5
pw2015_t2_relationship <- pw2015_t2_relationship %>% unite(pastrelationship5_name, pastrelationship5_m_name, pastrelationship5_f_name) %>%
      unite(pastrelationship5_name_new, pastrelationship5_name_m_new, pastrelationship5_name_f_new) %>% 
      unite(pastrelationship5_age_new, pastrelationship5_age_m_new, pastrelationship5_age_f_new) %>% 
      unite(pastrelationship5_height_new, pastrelationship5_height_m_new, pastrelationship5_height_f_new) %>% 
      unite(pastrelationship5_relationship_new, pastrelationship5_relationship_m_new, pastrelationship5_relationship_f_new) %>% 
      unite(pastrelationship5_duration_new, pastrelationship5_duration_m_new, pastrelationship5_duration_f_new) %>%
      unite(pastrelationship5_kind, pastrelationship5_kind_m, pastrelationship5_kind_f) %>%
      unite(pastrelationship5_start, pastrelationship5_start_m, pastrelationship5_start_f) %>%
      unite(pastrelationship5_end, pastrelationship5_end_m, pastrelationship5_end_f)
```

Divide variables, necessary when VPs had both male and female partners

Past relationship 1
```{r}
pw2015_t2_relationship$pastrelationship1_kind <- sub('_NA*','', pw2015_t2_relationship$pastrelationship1_kind)
pw2015_t2_relationship$pastrelationship1_kind <- sub('NA_*','', pw2015_t2_relationship$pastrelationship1_kind)
pw2015_t2_relationship$pastrelationship1_kind[pw2015_t2_relationship$pastrelationship1_kind==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship1_kind)) %>% separate(pastrelationship1_kind, c("pastrelationship1_kind","pastrelationship6_kind"), sep = "_")

pw2015_t2_relationship$pastrelationship1_start <- sub('_NA*','', pw2015_t2_relationship$pastrelationship1_start)
pw2015_t2_relationship$pastrelationship1_start <- sub('NA_*','', pw2015_t2_relationship$pastrelationship1_start)
pw2015_t2_relationship$pastrelationship1_start[pw2015_t2_relationship$pastrelationship1_start==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship1_start)) %>% separate(pastrelationship1_start, c("pastrelationship1_start","pastrelationship6_start"), sep = "_")

pw2015_t2_relationship$pastrelationship1_end <- sub('_NA*','', pw2015_t2_relationship$pastrelationship1_end)
pw2015_t2_relationship$pastrelationship1_end <- sub('NA_*','', pw2015_t2_relationship$pastrelationship1_end)
pw2015_t2_relationship$pastrelationship1_end[pw2015_t2_relationship$pastrelationship1_end==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship1_end)) %>% separate(pastrelationship1_end, c("pastrelationship1_end","pastrelationship6_end"), sep = "_")

pw2015_t2_relationship$pastrelationship1_name <- sub('_NA*','', pw2015_t2_relationship$pastrelationship1_name)
pw2015_t2_relationship$pastrelationship1_name <- sub('NA_*','', pw2015_t2_relationship$pastrelationship1_name)
pw2015_t2_relationship$pastrelationship1_name[pw2015_t2_relationship$pastrelationship1_name==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship1_name)) %>% separate(pastrelationship1_name, c("pastrelationship1_name","pastrelationship6_name"), sep = "_")

pw2015_t2_relationship$pastrelationship1_name_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship1_name_new)
pw2015_t2_relationship$pastrelationship1_name_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship1_name_new)
pw2015_t2_relationship$pastrelationship1_name_new[pw2015_t2_relationship$pastrelationship1_name_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship1_name_new)) %>% separate(pastrelationship1_name_new, c("pastrelationship1_name_new","pastrelationship6_name_new"), sep = "_")

pw2015_t2_relationship$pastrelationship1_age_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship1_age_new)
pw2015_t2_relationship$pastrelationship1_age_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship1_age_new)
pw2015_t2_relationship$pastrelationship1_age_new[pw2015_t2_relationship$pastrelationship1_age_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship1_age_new)) %>% separate(pastrelationship1_age_new, c("pastrelationship1_age_new","pastrelationship6_age_new"), sep = "_")

pw2015_t2_relationship$pastrelationship1_height_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship1_height_new)
pw2015_t2_relationship$pastrelationship1_height_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship1_height_new)
pw2015_t2_relationship$pastrelationship1_height_new[pw2015_t2_relationship$pastrelationship1_height_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship1_height_new)) %>% separate(pastrelationship1_height_new, c("pastrelationship1_height_new","pastrelationship6_height_new"), sep = "_")

pw2015_t2_relationship$pastrelationship1_relationship_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship1_relationship_new)
pw2015_t2_relationship$pastrelationship1_relationship_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship1_relationship_new)
pw2015_t2_relationship$pastrelationship1_relationship_new[pw2015_t2_relationship$pastrelationship1_relationship_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship1_relationship_new)) %>% separate(pastrelationship1_relationship_new, c("pastrelationship1_relationship_new","pastrelationship6_relationship_new"), sep = "_")

pw2015_t2_relationship$pastrelationship1_duration_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship1_duration_new)
pw2015_t2_relationship$pastrelationship1_duration_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship1_duration_new)
pw2015_t2_relationship$pastrelationship1_duration_new[pw2015_t2_relationship$pastrelationship1_duration_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship1_duration_new)) %>% separate(pastrelationship1_duration_new, c("pastrelationship1_duration_new","pastrelationship6_duration_new"), sep = "_")
```

Past relationship 2
```{r}
pw2015_t2_relationship$pastrelationship2_kind <- sub('_NA*','', pw2015_t2_relationship$pastrelationship2_kind)
pw2015_t2_relationship$pastrelationship2_kind <- sub('NA_*','', pw2015_t2_relationship$pastrelationship2_kind)
pw2015_t2_relationship$pastrelationship2_kind[pw2015_t2_relationship$pastrelationship2_kind==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship2_kind)) %>% separate(pastrelationship2_kind, c("pastrelationship2_kind","pastrelationship7_kind"), sep = "_")

pw2015_t2_relationship$pastrelationship2_start <- sub('_NA*','', pw2015_t2_relationship$pastrelationship2_start)
pw2015_t2_relationship$pastrelationship2_start <- sub('NA_*','', pw2015_t2_relationship$pastrelationship2_start)
pw2015_t2_relationship$pastrelationship2_start[pw2015_t2_relationship$pastrelationship2_start==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship2_start)) %>% separate(pastrelationship2_start, c("pastrelationship2_start","pastrelationship7_start"), sep = "_")

pw2015_t2_relationship$pastrelationship2_end <- sub('_NA*','', pw2015_t2_relationship$pastrelationship2_end)
pw2015_t2_relationship$pastrelationship2_end <- sub('NA_*','', pw2015_t2_relationship$pastrelationship2_end)
pw2015_t2_relationship$pastrelationship2_end[pw2015_t2_relationship$pastrelationship2_end==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship2_end)) %>% separate(pastrelationship2_end, c("pastrelationship2_end","pastrelationship7_end"), sep = "_")

pw2015_t2_relationship$pastrelationship2_name <- sub('_NA*','', pw2015_t2_relationship$pastrelationship2_name)
pw2015_t2_relationship$pastrelationship2_name <- sub('NA_*','', pw2015_t2_relationship$pastrelationship2_name)
pw2015_t2_relationship$pastrelationship2_name[pw2015_t2_relationship$pastrelationship2_name==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship2_name)) %>% separate(pastrelationship2_name, c("pastrelationship2_name","pastrelationship7_name"), sep = "_")

pw2015_t2_relationship$pastrelationship2_name_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship2_name_new)
pw2015_t2_relationship$pastrelationship2_name_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship2_name_new)
pw2015_t2_relationship$pastrelationship2_name_new[pw2015_t2_relationship$pastrelationship2_name_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship2_name_new)) %>% separate(pastrelationship2_name_new, c("pastrelationship2_name_new","pastrelationship7_name_new"), sep = "_")

pw2015_t2_relationship$pastrelationship2_age_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship2_age_new)
pw2015_t2_relationship$pastrelationship2_age_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship2_age_new)
pw2015_t2_relationship$pastrelationship2_age_new[pw2015_t2_relationship$pastrelationship2_age_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship2_age_new)) %>% separate(pastrelationship2_age_new, c("pastrelationship2_age_new","pastrelationship7_age_new"), sep = "_")

pw2015_t2_relationship$pastrelationship2_height_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship2_height_new)
pw2015_t2_relationship$pastrelationship2_height_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship2_height_new)
pw2015_t2_relationship$pastrelationship2_height_new[pw2015_t2_relationship$pastrelationship2_height_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship2_height_new)) %>% separate(pastrelationship2_height_new, c("pastrelationship2_height_new","pastrelationship7_height_new"), sep = "_")

pw2015_t2_relationship$pastrelationship2_relationship_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship2_relationship_new)
pw2015_t2_relationship$pastrelationship2_relationship_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship2_relationship_new)
pw2015_t2_relationship$pastrelationship2_relationship_new[pw2015_t2_relationship$pastrelationship2_relationship_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship2_relationship_new)) %>% separate(pastrelationship2_relationship_new, c("pastrelationship2_relationship_new","pastrelationship7_relationship_new"), sep = "_")

pw2015_t2_relationship$pastrelationship2_duration_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship2_duration_new)
pw2015_t2_relationship$pastrelationship2_duration_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship2_duration_new)
pw2015_t2_relationship$pastrelationship2_duration_new[pw2015_t2_relationship$pastrelationship2_duration_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship2_duration_new)) %>% separate(pastrelationship2_duration_new, c("pastrelationship2_duration_new","pastrelationship7_duration_new"), sep = "_")
```

Past relationship 3
```{r}
pw2015_t2_relationship$pastrelationship3_kind <- sub('_NA*','', pw2015_t2_relationship$pastrelationship3_kind)
pw2015_t2_relationship$pastrelationship3_kind <- sub('NA_*','', pw2015_t2_relationship$pastrelationship3_kind)
pw2015_t2_relationship$pastrelationship3_kind[pw2015_t2_relationship$pastrelationship3_kind==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship3_kind)) %>% separate(pastrelationship3_kind, c("pastrelationship3_kind","pastrelationship8_kind"), sep = "_")

pw2015_t2_relationship$pastrelationship3_start <- sub('_NA*','', pw2015_t2_relationship$pastrelationship3_start)
pw2015_t2_relationship$pastrelationship3_start <- sub('NA_*','', pw2015_t2_relationship$pastrelationship3_start)
pw2015_t2_relationship$pastrelationship3_start[pw2015_t2_relationship$pastrelationship3_start==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship3_start)) %>% separate(pastrelationship3_start, c("pastrelationship3_start","pastrelationship8_start"), sep = "_")

pw2015_t2_relationship$pastrelationship3_end <- sub('_NA*','', pw2015_t2_relationship$pastrelationship3_end)
pw2015_t2_relationship$pastrelationship3_end <- sub('NA_*','', pw2015_t2_relationship$pastrelationship3_end)
pw2015_t2_relationship$pastrelationship3_end[pw2015_t2_relationship$pastrelationship3_end==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship3_end)) %>% separate(pastrelationship3_end, c("pastrelationship3_end","pastrelationship8_end"), sep = "_")

pw2015_t2_relationship$pastrelationship3_name <- sub('_NA*','', pw2015_t2_relationship$pastrelationship3_name)
pw2015_t2_relationship$pastrelationship3_name <- sub('NA_*','', pw2015_t2_relationship$pastrelationship3_name)
pw2015_t2_relationship$pastrelationship3_name[pw2015_t2_relationship$pastrelationship3_name==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship3_name)) %>% separate(pastrelationship3_name, c("pastrelationship3_name","pastrelationship8_name"), sep = "_")

pw2015_t2_relationship$pastrelationship3_name_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship3_name_new)
pw2015_t2_relationship$pastrelationship3_name_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship3_name_new)
pw2015_t2_relationship$pastrelationship3_name_new[pw2015_t2_relationship$pastrelationship3_name_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship3_name_new)) %>% separate(pastrelationship3_name_new, c("pastrelationship3_name_new","pastrelationship8_name_new"), sep = "_")

pw2015_t2_relationship$pastrelationship3_age_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship3_age_new)
pw2015_t2_relationship$pastrelationship3_age_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship3_age_new)
pw2015_t2_relationship$pastrelationship3_age_new[pw2015_t2_relationship$pastrelationship3_age_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship3_age_new)) %>% separate(pastrelationship3_age_new, c("pastrelationship3_age_new","pastrelationship8_age_new"), sep = "_")

pw2015_t2_relationship$pastrelationship3_height_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship3_height_new)
pw2015_t2_relationship$pastrelationship3_height_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship3_height_new)
pw2015_t2_relationship$pastrelationship3_height_new[pw2015_t2_relationship$pastrelationship3_height_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship3_height_new)) %>% separate(pastrelationship3_height_new, c("pastrelationship3_height_new","pastrelationship8_height_new"), sep = "_")

pw2015_t2_relationship$pastrelationship3_relationship_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship3_relationship_new)
pw2015_t2_relationship$pastrelationship3_relationship_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship3_relationship_new)
pw2015_t2_relationship$pastrelationship3_relationship_new[pw2015_t2_relationship$pastrelationship3_relationship_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship3_relationship_new)) %>% separate(pastrelationship3_relationship_new, c("pastrelationship3_relationship_new","pastrelationship8_relationship_new"), sep = "_")

pw2015_t2_relationship$pastrelationship3_duration_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship3_duration_new)
pw2015_t2_relationship$pastrelationship3_duration_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship3_duration_new)
pw2015_t2_relationship$pastrelationship3_duration_new[pw2015_t2_relationship$pastrelationship3_duration_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship3_duration_new)) %>% separate(pastrelationship3_duration_new, c("pastrelationship3_duration_new","pastrelationship8_duration_new"), sep = "_")
```

Past relationship 4
```{r}
pw2015_t2_relationship$pastrelationship4_kind <- sub('_NA*','', pw2015_t2_relationship$pastrelationship4_kind)
pw2015_t2_relationship$pastrelationship4_kind <- sub('NA_*','', pw2015_t2_relationship$pastrelationship4_kind)
pw2015_t2_relationship$pastrelationship4_kind[pw2015_t2_relationship$pastrelationship4_kind==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship4_kind)) %>% separate(pastrelationship4_kind, c("pastrelationship4_kind","pastrelationship9_kind"), sep = "_")

pw2015_t2_relationship$pastrelationship4_start <- sub('_NA*','', pw2015_t2_relationship$pastrelationship4_start)
pw2015_t2_relationship$pastrelationship4_start <- sub('NA_*','', pw2015_t2_relationship$pastrelationship4_start)
pw2015_t2_relationship$pastrelationship4_start[pw2015_t2_relationship$pastrelationship4_start==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship4_start)) %>% separate(pastrelationship4_start, c("pastrelationship4_start","pastrelationship9_start"), sep = "_")

pw2015_t2_relationship$pastrelationship4_end <- sub('_NA*','', pw2015_t2_relationship$pastrelationship4_end)
pw2015_t2_relationship$pastrelationship4_end <- sub('NA_*','', pw2015_t2_relationship$pastrelationship4_end)
pw2015_t2_relationship$pastrelationship4_end[pw2015_t2_relationship$pastrelationship4_end==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship4_end)) %>% separate(pastrelationship4_end, c("pastrelationship4_end","pastrelationship9_end"), sep = "_")

pw2015_t2_relationship$pastrelationship4_name <- sub('_NA*','', pw2015_t2_relationship$pastrelationship4_name)
pw2015_t2_relationship$pastrelationship4_name <- sub('NA_*','', pw2015_t2_relationship$pastrelationship4_name)
pw2015_t2_relationship$pastrelationship4_name[pw2015_t2_relationship$pastrelationship4_name==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship4_name)) %>% separate(pastrelationship4_name, c("pastrelationship4_name","pastrelationship9_name"), sep = "_")

pw2015_t2_relationship$pastrelationship4_name_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship4_name_new)
pw2015_t2_relationship$pastrelationship4_name_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship4_name_new)
pw2015_t2_relationship$pastrelationship4_name_new[pw2015_t2_relationship$pastrelationship4_name_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship4_name_new)) %>% separate(pastrelationship4_name_new, c("pastrelationship4_name_new","pastrelationship9_name_new"), sep = "_")

pw2015_t2_relationship$pastrelationship4_age_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship4_age_new)
pw2015_t2_relationship$pastrelationship4_age_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship4_age_new)
pw2015_t2_relationship$pastrelationship4_age_new[pw2015_t2_relationship$pastrelationship4_age_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship4_age_new)) %>% separate(pastrelationship4_age_new, c("pastrelationship4_age_new","pastrelationship9_age_new"), sep = "_")

pw2015_t2_relationship$pastrelationship4_height_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship4_height_new)
pw2015_t2_relationship$pastrelationship4_height_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship4_height_new)
pw2015_t2_relationship$pastrelationship4_height_new[pw2015_t2_relationship$pastrelationship4_height_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship4_height_new)) %>% separate(pastrelationship4_height_new, c("pastrelationship4_height_new","pastrelationship9_height_new"), sep = "_")

pw2015_t2_relationship$pastrelationship4_relationship_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship4_relationship_new)
pw2015_t2_relationship$pastrelationship4_relationship_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship4_relationship_new)
pw2015_t2_relationship$pastrelationship4_relationship_new[pw2015_t2_relationship$pastrelationship4_relationship_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship4_relationship_new)) %>% separate(pastrelationship4_relationship_new, c("pastrelationship4_relationship_new","pastrelationship9_relationship_new"), sep = "_")

pw2015_t2_relationship$pastrelationship4_duration_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship4_duration_new)
pw2015_t2_relationship$pastrelationship4_duration_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship4_duration_new)
pw2015_t2_relationship$pastrelationship4_duration_new[pw2015_t2_relationship$pastrelationship4_duration_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship4_duration_new)) %>% separate(pastrelationship4_duration_new, c("pastrelationship4_duration_new","pastrelationship9_duration_new"), sep = "_")
```

Past relationship 5
```{r}
pw2015_t2_relationship$pastrelationship5_kind <- sub('_NA*','', pw2015_t2_relationship$pastrelationship5_kind)
pw2015_t2_relationship$pastrelationship5_kind <- sub('NA_*','', pw2015_t2_relationship$pastrelationship5_kind)
pw2015_t2_relationship$pastrelationship5_kind[pw2015_t2_relationship$pastrelationship1_kind==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship5_kind)) %>% separate(pastrelationship5_kind, c("pastrelationship5_kind","pastrelationship10_kind"), sep = "_")

pw2015_t2_relationship$pastrelationship5_start <- sub('_NA*','', pw2015_t2_relationship$pastrelationship5_start)
pw2015_t2_relationship$pastrelationship5_start <- sub('NA_*','', pw2015_t2_relationship$pastrelationship5_start)
pw2015_t2_relationship$pastrelationship5_start[pw2015_t2_relationship$pastrelationship5_start==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship5_start)) %>% separate(pastrelationship5_start, c("pastrelationship5_start","pastrelationship10_start"), sep = "_")

pw2015_t2_relationship$pastrelationship5_end <- sub('_NA*','', pw2015_t2_relationship$pastrelationship5_end)
pw2015_t2_relationship$pastrelationship5_end <- sub('NA_*','', pw2015_t2_relationship$pastrelationship5_end)
pw2015_t2_relationship$pastrelationship5_end[pw2015_t2_relationship$pastrelationship5_end==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship5_end)) %>% separate(pastrelationship5_end, c("pastrelationship5_end","pastrelationship10_end"), sep = "_")

pw2015_t2_relationship$pastrelationship5_name <- sub('_NA*','', pw2015_t2_relationship$pastrelationship5_name)
pw2015_t2_relationship$pastrelationship5_name <- sub('NA_*','', pw2015_t2_relationship$pastrelationship5_name)
pw2015_t2_relationship$pastrelationship5_name[pw2015_t2_relationship$pastrelationship5_name==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship5_name)) %>% separate(pastrelationship5_name, c("pastrelationship5_name","pastrelationship10_name"), sep = "_")

pw2015_t2_relationship$pastrelationship5_name_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship5_name_new)
pw2015_t2_relationship$pastrelationship5_name_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship5_name_new)
pw2015_t2_relationship$pastrelationship5_name_new[pw2015_t2_relationship$pastrelationship5_name_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship5_name_new)) %>% separate(pastrelationship5_name_new, c("pastrelationship5_name_new","pastrelationship10_name_new"), sep = "_")

pw2015_t2_relationship$pastrelationship5_age_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship5_age_new)
pw2015_t2_relationship$pastrelationship5_age_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship5_age_new)
pw2015_t2_relationship$pastrelationship5_age_new[pw2015_t2_relationship$pastrelationship5_age_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship5_age_new)) %>% separate(pastrelationship5_age_new, c("pastrelationship5_age_new","pastrelationship10_age_new"), sep = "_")

pw2015_t2_relationship$pastrelationship5_height_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship5_height_new)
pw2015_t2_relationship$pastrelationship5_height_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship5_height_new)
pw2015_t2_relationship$pastrelationship5_height_new[pw2015_t2_relationship$pastrelationship5_height_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship5_height_new)) %>% separate(pastrelationship5_height_new, c("pastrelationship5_height_new","pastrelationship10_height_new"), sep = "_")

pw2015_t2_relationship$pastrelationship5_relationship_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship5_relationship_new)
pw2015_t2_relationship$pastrelationship5_relationship_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship5_relationship_new)
pw2015_t2_relationship$pastrelationship5_relationship_new[pw2015_t2_relationship$pastrelationship5_relationship_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship5_relationship_new)) %>% separate(pastrelationship5_relationship_new, c("pastrelationship5_relationship_new","pastrelationship10_relationship_new"), sep = "_")

pw2015_t2_relationship$pastrelationship5_duration_new <- sub('_NA*','', pw2015_t2_relationship$pastrelationship5_duration_new)
pw2015_t2_relationship$pastrelationship5_duration_new <- sub('NA_*','', pw2015_t2_relationship$pastrelationship5_duration_new)
pw2015_t2_relationship$pastrelationship5_duration_new[pw2015_t2_relationship$pastrelationship5_duration_new==""]  <- NA 
pw2015_t2_relationship <- pw2015_t2_relationship %>% group_by(grepl('_', pastrelationship5_duration_new)) %>% separate(pastrelationship5_duration_new, c("pastrelationship5_duration_new","pastrelationship10_duration_new"), sep = "_")
```

Bring data with new variables in proper order
```{r}
#Delete grouping-variable "grepl"
pw2015_t2_relationship <- pw2015_t2_relationship %>% select( -starts_with("grepl"))

pw2015_t2_relationship <- pw2015_t2_relationship %>% select(-relationship_m, -relationship_f, -pastrelationship1_m,
                          -pastrelationship1_f, -pastrelationship2_m, -pastrelationship2_f, -pastrelationship3_m,
                          -pastrelationship3_f, -pastrelationship4_m, -pastrelationship4_f, -pastrelationship5_m,
                          -pastrelationship5_f, -pastrelationship6_m, -pastrelationship6_f,
                          -pastrelationshipmore_m, -pastrelationshipmore_f)

pw2015_t2_relationship <- pw2015_t2_relationship %>% select(session, short_session, t2_relationship, t2_pastrelationship, starts_with("relationship"), starts_with("pastrelationship"))


```

```{r}
pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
    relationship1.name = relationship1_name, relationship1.name_new = relationship1_name_new, 
    relationship1.age_new = relationship1_age_new, relationship1.height_new = relationship1_height_new,
    relationship1.relationship_new = relationship1_relationship_new, relationship1.duration_new = 
    relationship1_duration_new, relationship1.kind = relationship1_kind, relationship1.start = relationship1_start, 
    relationship2.name = relationship2_name, relationship2.name_new = relationship2_name_new, 
    relationship2.age_new = relationship2_age_new, relationship2.height_new = relationship2_height_new, 
    relationship2.relationship_new = relationship2_relationship_new, relationship2.duration_new = 
    relationship2_duration_new, relationship2.kind = relationship2_kind, relationship2.start = relationship2_start, 
    relationship3.name = relationship3_name, relationship3.name_new = relationship3_name_new, 
    relationship3.age_new = relationship3_age_new, relationship3.height_new = relationship3_height_new,
    relationship3.relationship_new = relationship3_relationship_new, relationship3.duration_new = 
    relationship3_duration_new, relationship3.kind = relationship3_kind, relationship3.start = relationship3_start, 
    relationship4.name = relationship4_name, relationship4.name_new = relationship4_name_new, 
    relationship4.age_new = relationship4_age_new, relationship4.height_new = relationship4_height_new, 
    relationship4.relationship_new = relationship4_relationship_new, relationship4.duration_new = 
    relationship4_duration_new, relationship4.kind = relationship4_kind, relationship4.start = relationship4_start,            relationship5.name = relationship5_name, relationship5.name_new = relationship5_name_new, 
    relationship5.age_new = relationship5_age_new, relationship5.height_new = relationship5_height_new,
    relationship5.relationship_new = relationship5_relationship_new, relationship5.duration_new = 
    relationship5_duration_new, relationship5.kind = relationship5_kind, relationship5.start = relationship5_start, 
    relationship6.name = relationship6_name, relationship6.name_new = relationship6_name_new, 
    relationship6.age_new = relationship6_age_new, relationship6.height_new = relationship6_height_new, 
    relationship6.relationship_new = relationship6_relationship_new, relationship6.duration_new = 
    relationship6_duration_new, relationship6.kind = relationship6_kind, relationship6.start = relationship6_start, 
    pastrelationship1.name = pastrelationship1_name, pastrelationship1.name_new = pastrelationship1_name_new,  
    pastrelationship1.age_new = pastrelationship1_age_new, pastrelationship1.height_new = 
    pastrelationship1_height_new, pastrelationship1.relationship_new = pastrelationship1_relationship_new, 
    pastrelationship1.duration_new = pastrelationship1_duration_new, pastrelationship1.kind = 
    pastrelationship1_kind, pastrelationship1.start = pastrelationship1_start, pastrelationship1.end = 
    pastrelationship1_end,
    pastrelationship2.name = pastrelationship2_name, pastrelationship2.name_new = pastrelationship2_name_new,  
    pastrelationship2.age_new = pastrelationship2_age_new, pastrelationship2.height_new = 
    pastrelationship2_height_new, pastrelationship2.relationship_new = pastrelationship2_relationship_new, 
    pastrelationship2.duration_new = pastrelationship2_duration_new, pastrelationship2.kind = 
    pastrelationship2_kind, pastrelationship2.start = pastrelationship2_start, pastrelationship2.end = 
    pastrelationship2_end,
    pastrelationship3.name = pastrelationship3_name, pastrelationship3.name_new = pastrelationship3_name_new,  
    pastrelationship3.age_new = pastrelationship3_age_new, pastrelationship3.height_new = 
    pastrelationship3_height_new, pastrelationship3.relationship_new = pastrelationship3_relationship_new, 
    pastrelationship3.duration_new = pastrelationship3_duration_new, pastrelationship3.kind = 
    pastrelationship3_kind, pastrelationship3.start = pastrelationship3_start, pastrelationship3.end = 
    pastrelationship3_end,
    pastrelationship4.name = pastrelationship4_name, pastrelationship4.name_new = pastrelationship4_name_new,  
    pastrelationship4.age_new = pastrelationship4_age_new, pastrelationship4.height_new = 
    pastrelationship4_height_new, pastrelationship4.relationship_new = pastrelationship4_relationship_new, 
    pastrelationship4.duration_new = pastrelationship4_duration_new, pastrelationship4.kind = 
    pastrelationship4_kind, pastrelationship4.start = pastrelationship4_start, pastrelationship4.end = 
    pastrelationship4_end,
    pastrelationship5.name = pastrelationship5_name, pastrelationship5.name_new = pastrelationship5_name_new,  
    pastrelationship5.age_new = pastrelationship5_age_new, pastrelationship5.height_new = 
    pastrelationship5_height_new, pastrelationship5.relationship_new = pastrelationship5_relationship_new, 
    pastrelationship5.duration_new = pastrelationship5_duration_new, pastrelationship5.kind = 
    pastrelationship5_kind, pastrelationship5.start = pastrelationship5_start, pastrelationship5.end = 
    pastrelationship5_end,
    pastrelationship6.name = pastrelationship6_name, pastrelationship6.name_new = pastrelationship6_name_new,  
    pastrelationship6.age_new = pastrelationship6_age_new, pastrelationship6.height_new = 
    pastrelationship6_height_new, pastrelationship6.relationship_new = pastrelationship6_relationship_new, 
    pastrelationship6.duration_new = pastrelationship6_duration_new, pastrelationship6.kind = 
    pastrelationship6_kind, pastrelationship6.start = pastrelationship6_start, pastrelationship6.end = 
    pastrelationship6_end,
    pastrelationship7.name = pastrelationship7_name, pastrelationship7.name_new = pastrelationship7_name_new,  
    pastrelationship7.age_new = pastrelationship7_age_new, pastrelationship7.height_new = 
    pastrelationship7_height_new, pastrelationship7.relationship_new = pastrelationship7_relationship_new, 
    pastrelationship7.duration_new = pastrelationship7_duration_new, pastrelationship7.kind = 
    pastrelationship7_kind, pastrelationship7.start = pastrelationship7_start, pastrelationship7.end = 
    pastrelationship7_end,
    pastrelationship8.name = pastrelationship8_name, pastrelationship8.name_new = pastrelationship8_name_new,  
    pastrelationship8.age_new = pastrelationship8_age_new, pastrelationship8.height_new = 
    pastrelationship8_height_new, pastrelationship8.relationship_new = pastrelationship8_relationship_new, 
    pastrelationship8.duration_new = pastrelationship8_duration_new, pastrelationship8.kind = 
    pastrelationship8_kind, pastrelationship8.start = pastrelationship8_start, pastrelationship8.end = 
    pastrelationship8_end,
    pastrelationship9.name = pastrelationship9_name, pastrelationship9.name_new = pastrelationship9_name_new,  
    pastrelationship9.age_new = pastrelationship9_age_new, pastrelationship9.height_new = 
    pastrelationship9_height_new, pastrelationship9.relationship_new = pastrelationship9_relationship_new, 
    pastrelationship9.duration_new = pastrelationship9_duration_new, pastrelationship9.kind = 
    pastrelationship9_kind, pastrelationship9.start = pastrelationship9_start, pastrelationship9.end = 
    pastrelationship9_end,
    pastrelationship10.name = pastrelationship10_name, pastrelationship10.name_new = pastrelationship10_name_new,  
    pastrelationship10.age_new = pastrelationship10_age_new, pastrelationship10.height_new = 
    pastrelationship10_height_new, pastrelationship10.relationship_new = pastrelationship10_relationship_new, 
    pastrelationship10.duration_new = pastrelationship10_duration_new, pastrelationship10.kind = 
    pastrelationship10_kind, pastrelationship10.start = pastrelationship10_start, pastrelationship10.end = 
    pastrelationship10_end)

pw2015_t2_relationship <- pw2015_t2_relationship %>% select( -starts_with("relationship1_"),  
                        -starts_with("relationship2_"),  -starts_with("relationship3_"),  -starts_with("relationship4_"),  
                        -starts_with("relationship5_"),  -starts_with("relationship6_"),-starts_with("pastrelationship1_"),
                        -starts_with("pastrelationship2_"), -starts_with("pastrelationship3_"), 
                        -starts_with("pastrelationship4_"), -starts_with("pastrelationship5_"), 
                        -starts_with("pastrelationship6_"), -starts_with("pastrelationship7_"),
                        -starts_with("pastrelationship8_"), -starts_with("pastrelationship9_"),
                        -starts_with("pastrelationship10_"))
                                                                  
pw2015_t2_relationship <- pw2015_t2_relationship %>% mutate(
  "relationship1.end" = NA, "relationship2.end" = NA, "relationship3.end" = NA,
  "relationship4.end" = NA, "relationship5.end" = NA, "relationship6.end" = NA
)


pw2015_t2_relationship <- subset(pw2015_t2_relationship, !duplicated(short_session))

pw2015_t2_relationship <- as.data.frame(pw2015_t2_relationship)
```


```{r}
pw2015_t2_relationship <- pw2015_t2_relationship %>% select(session, short_session, t2_relationship, t2_pastrelationship,
                        relationship1.name, relationship1.name_new, relationship1.age_new, 
                        relationship1.height_new,
                  relationship1.relationship_new, relationship1.duration_new, relationship1.kind,
                  relationship1.start, relationship1.end,
                  relationship2.name, relationship2.name_new, relationship2.age_new,
                  relationship2.height_new, relationship2.relationship_new, relationship2.duration_new, 
                  relationship2.kind, relationship2.start, relationship2.end,
                  relationship3.name, relationship3.name_new, relationship3.age_new, relationship3.height_new,
                  relationship3.relationship_new, relationship3.duration_new, relationship3.kind,
                  relationship3.start, relationship3.end,
                  relationship4.name, relationship4.name_new, relationship4.age_new,
                  relationship4.height_new, relationship4.relationship_new, relationship4.duration_new, 
                  relationship4.kind, relationship4.start, relationship4.end,
                  relationship5.name, relationship5.name_new, relationship5.age_new,
                  relationship5.height_new, relationship5.relationship_new, relationship5.duration_new, 
                  relationship5.kind, relationship5.start, relationship5.end,
                  relationship6.name, relationship6.name_new, relationship6.age_new,
                  relationship6.height_new, relationship6.relationship_new, relationship6.duration_new, 
                  relationship6.kind, relationship6.start, relationship6.end,
                  pastrelationship1.name, pastrelationship1.name_new, pastrelationship1.age_new, 
                  pastrelationship1.height_new, pastrelationship1.relationship_new, pastrelationship1.duration_new, 
                  pastrelationship1.kind ,pastrelationship1.start, pastrelationship1.end,
                  pastrelationship2.name, pastrelationship2.name_new, pastrelationship2.age_new, 
                  pastrelationship2.height_new, pastrelationship2.relationship_new, pastrelationship2.duration_new, 
                  pastrelationship2.kind, pastrelationship2.start, pastrelationship2.end,
                  pastrelationship3.name, pastrelationship3.name_new, pastrelationship3.age_new, 
                  pastrelationship3.height_new, pastrelationship3.relationship_new, pastrelationship3.duration_new, 
                  pastrelationship3.kind, pastrelationship3.start, pastrelationship3.end,
                  pastrelationship4.name, pastrelationship4.name_new, pastrelationship4.age_new, 
                  pastrelationship4.height_new, pastrelationship4.relationship_new, pastrelationship4.duration_new, 
                  pastrelationship4.kind, pastrelationship4.start, pastrelationship4.end,
                  pastrelationship5.name, pastrelationship5.name_new, pastrelationship5.age_new, 
                  pastrelationship5.height_new, pastrelationship5.relationship_new, pastrelationship5.duration_new, 
                  pastrelationship5.kind, pastrelationship5.start, pastrelationship5.end,
                  pastrelationship6.name, pastrelationship6.name_new, pastrelationship6.age_new, 
                  pastrelationship6.height_new, pastrelationship6.relationship_new, pastrelationship6.duration_new, 
                  pastrelationship6.kind, pastrelationship6.start, pastrelationship6.end,
                  pastrelationship7.name, pastrelationship7.name_new, pastrelationship7.age_new, 
                  pastrelationship7.height_new, pastrelationship7.relationship_new, pastrelationship7.duration_new, 
                  pastrelationship7.kind, pastrelationship7.start, pastrelationship7.end,
                  pastrelationship8.name, pastrelationship8.name_new, pastrelationship8.age_new, 
                  pastrelationship8.height_new, pastrelationship8.relationship_new, pastrelationship8.duration_new, 
                  pastrelationship8.kind, pastrelationship8.start, pastrelationship8.end,
                  pastrelationship9.name, pastrelationship9.name_new, pastrelationship9.age_new, 
                  pastrelationship9.height_new, pastrelationship9.relationship_new, pastrelationship9.duration_new, 
                  pastrelationship9.kind, pastrelationship9.start, pastrelationship9.end,
                  pastrelationship10.name, pastrelationship10.name_new, pastrelationship10.age_new, 
                  pastrelationship10.height_new, pastrelationship10.relationship_new, pastrelationship10.duration_new,                  pastrelationship10.kind, pastrelationship10.start, pastrelationship10.end)
```


```{r}
pw2015_t2_relationship <- reshape(pw2015_t2_relationship, direction='long', 
        varying=c('relationship1.name', 'relationship1.name_new', 'relationship1.age_new', 'relationship1.height_new',
                  'relationship1.relationship_new', 'relationship1.duration_new', 'relationship1.kind',
                  'relationship1.start', 'relationship1.end',
                  'relationship2.name', 'relationship2.name_new', 'relationship2.age_new',
                  'relationship2.height_new', 'relationship2.relationship_new', 'relationship2.duration_new', 
                  'relationship2.kind', 'relationship2.start', 'relationship2.end',
                  'relationship3.name', 'relationship3.name_new', 'relationship3.age_new', 'relationship3.height_new',
                  'relationship3.relationship_new', 'relationship3.duration_new', 'relationship3.kind',
                  'relationship3.start', 'relationship3.end',
                  'relationship4.name', 'relationship4.name_new', 'relationship4.age_new',
                  'relationship4.height_new', 'relationship4.relationship_new', 'relationship4.duration_new', 
                  'relationship4.kind', 'relationship4.start', 'relationship4.end',
                  'relationship5.name', 'relationship5.name_new', 'relationship5.age_new',
                  'relationship5.height_new', 'relationship5.relationship_new', 'relationship5.duration_new', 
                  'relationship5.kind', 'relationship5.start', 'relationship5.end',
                  'relationship6.name', 'relationship6.name_new', 'relationship6.age_new',
                  'relationship6.height_new', 'relationship6.relationship_new', 'relationship6.duration_new', 
                  'relationship6.kind', 'relationship6.start', 'relationship6.end',
                  "pastrelationship1.name", "pastrelationship1.name_new", "pastrelationship1.age_new", 
                  "pastrelationship1.height_new","pastrelationship1.relationship_new", "pastrelationship1.duration_new", 
                  "pastrelationship1.kind","pastrelationship1.start", "pastrelationship1.end",
                  "pastrelationship2.name", "pastrelationship2.name_new", "pastrelationship2.age_new", 
                  "pastrelationship2.height_new","pastrelationship2.relationship_new", "pastrelationship2.duration_new", 
                  "pastrelationship2.kind","pastrelationship2.start", "pastrelationship2.end",
                  "pastrelationship3.name", "pastrelationship3.name_new", "pastrelationship3.age_new", 
                  "pastrelationship3.height_new","pastrelationship3.relationship_new", "pastrelationship3.duration_new", 
                  "pastrelationship3.kind","pastrelationship3.start", "pastrelationship3.end",
                  "pastrelationship4.name", "pastrelationship4.name_new", "pastrelationship4.age_new", 
                  "pastrelationship4.height_new","pastrelationship4.relationship_new", "pastrelationship4.duration_new", 
                  "pastrelationship4.kind","pastrelationship4.start", "pastrelationship4.end",
                  "pastrelationship5.name", "pastrelationship5.name_new", "pastrelationship5.age_new", 
                  "pastrelationship5.height_new","pastrelationship5.relationship_new", "pastrelationship5.duration_new", 
                  "pastrelationship5.kind","pastrelationship5.start", "pastrelationship5.end",
                  "pastrelationship6.name", "pastrelationship6.name_new", "pastrelationship6.age_new", 
                  "pastrelationship6.height_new","pastrelationship6.relationship_new", "pastrelationship6.duration_new", 
                  "pastrelationship6.kind","pastrelationship6.start", "pastrelationship6.end",
                  "pastrelationship7.name", "pastrelationship7.name_new", "pastrelationship7.age_new", 
                  "pastrelationship7.height_new","pastrelationship7.relationship_new", "pastrelationship7.duration_new", 
                  "pastrelationship7.kind","pastrelationship7.start", "pastrelationship7.end",
                  "pastrelationship8.name", "pastrelationship8.name_new", "pastrelationship8.age_new", 
                  "pastrelationship8.height_new","pastrelationship8.relationship_new", "pastrelationship8.duration_new", 
                  "pastrelationship8.kind","pastrelationship8.start", "pastrelationship8.end",
                  "pastrelationship9.name", "pastrelationship9.name_new", "pastrelationship9.age_new", 
                  "pastrelationship9.height_new","pastrelationship9.relationship_new", "pastrelationship9.duration_new", 
                  "pastrelationship9.kind","pastrelationship9.start", "pastrelationship9.end",
                  "pastrelationship10.name", "pastrelationship10.name_new", "pastrelationship10.age_new", 
                  "pastrelationship10.height_new","pastrelationship10.relationship_new", "pastrelationship10.duration_new",                   "pastrelationship10.kind","pastrelationship10.start", "pastrelationship10.end"),
             timevar='var',
        times=c('relationship1', 'relationship2', 'relationship3', 'relationship4', 'relationship5', 'relationship6',
                'pastrelationship1', 'pastrelationship2', 'pastrelationship3', 'pastrelationship4', 'pastrelationship5',
                'pastrelationship6', 'pastrelationship7', 'pastrelationship8', 'pastrelationship9', 'pastrelationship10'),
        v.names=c('name', 'name_new', 'age_new', 'height_new', 'relationship_new', 'duration_new', 'kind', 'start', 'end'),
        idvar='short_session')

```


# Relationship t3

```{r}
pw2015_t3_partners = pw2015_t3_partners %>% 
  group_by(session) %>%
  arrange(session, F_t3_start) %>%
  mutate(relationship_number = n(),
         relationship_order = row_number())
```

# Merge Relationship Data
```{r}

```


```{r}

## one longterm variable for "focal" preferred sex,
## based on own sex
Data$longterm_GESAMT <- NA
Data$longterm_GESAMT[Data$sex==1] <- Data$longterm_m[Data$sex==1]
Data$longterm_GESAMT[Data$sex==2] <- Data$longterm_f[Data$sex==2]


```


