---
title: "01_datawrangling"
author: "Laura Botzet, Sarah Forsthoff, Tanja Gerlach"
output: html_document
---

##Data Import 

# Working directory festlegen, später entsprechend anpassen
```{r}

```

# Libraries laden (ggf. vorher installieren mit install.packages)
# Für den select-Befehl, den wir unten verwenden wollen z.B. braucht man dplyr
# Zum Verkürzen des Session_Codes stringr
# formr auch laden und psych braucht man auch fast immer 
# Später kommen dann andere dazu
```{r}
library(formr); library(psych); library(dplyr); library(stringr)
```



# Sheets einlesen
```{r}
pw2015_demographie <- read.csv2("/Users/tgerlac/ownCloud/DB_Sicherung/__BAs/__BAs 2017/Charlotte Wegener/Daten_CW/pw2015_demographie.csv")
pw2015_items <- read.csv2("/Users/tgerlac/ownCloud/DB_Sicherung/__BAs/__BAs 2017/Charlotte Wegener/Daten_CW/pw2015_items.csv")
pw2015_t2 <- read.csv2("/Users/tgerlac/ownCloud/DB_Sicherung/__BAs/__BAs 2017/Charlotte Wegener/Daten_CW/pw2015_t2.csv")
pw2015_t2_frauen <- read.csv2("/Users/tgerlac/ownCloud/DB_Sicherung/__BAs/__BAs 2017/Charlotte Wegener/Daten_CW/pw2015_t2_frauen.csv")
pw2015_t2_ende <- read.csv2("/Users/tgerlac/ownCloud/DB_Sicherung/__BAs/__BAs 2017/Charlotte Wegener/Daten_CW/pw2015_t2_ende.csv")
pw2015_t3_start <- read.csv2("/Users/tgerlac/ownCloud/DB_Sicherung/__BAs/__BAs 2017/Charlotte Wegener/Daten_CW/pw2015_t3_start.csv")
pw2015_t3_singles <- read.csv2("/Users/tgerlac/ownCloud/DB_Sicherung/__BAs/__BAs 2017/Charlotte Wegener/Daten_CW/pw2015_t3_singles.csv")
pw2015_t3_relationship_number <- read.csv2("/Users/tgerlac/ownCloud/DB_Sicherung/__BAs/__BAs 2017/Charlotte Wegener/Daten_CW/pw2015_t3_relationship_number.csv")
#pw2015_t3_rate_partners <- read.csv2("/Users/tgerlac/ownCloud/DB_Sicherung/__BAs/__BAs 2017/Charlotte Wegener/Daten_CW/pw2015_t3_rate_partners.csv")
#Meiner Meinung nach brauche ich keine Variablen aus dem sheet "_rate_partners"
pw2015_t3_partners <- read.csv2("/Users/tgerlac/ownCloud/DB_Sicherung/__BAs/__BAs 2017/Charlotte Wegener/Daten_CW/pw2015_t3_partners.csv")
pw2015_t3_mainrelation <- read.csv2("/Users/tgerlac/ownCloud/DB_Sicherung/__BAs/__BAs 2017/Charlotte Wegener/Daten_CW/pw2015_t3_mainrelation.csv")
pw2015_t3_ende <- read.csv2("/Users/tgerlac/ownCloud/DB_Sicherung/__BAs/__BAs 2017/Charlotte Wegener/Daten_CW/pw2015_t3_ende.csv")
```


# Kurzvariable für erste 10 Zeichen des Session-Codes erstellen
```{r}
pw2015_demographie$short_session = str_sub(pw2015_demographie$session,1,10)
pw2015_items$short_session = str_sub(pw2015_items$session,1,10)
pw2015_t2$short_session = str_sub(pw2015_t2$session,1,10)
pw2015_t2_frauen$short_session = str_sub(pw2015_t2_frauen$session,1,10)
pw2015_t2_ende$short_session = str_sub(pw2015_t2_ende$session,1,10)
pw2015_t3_start$short_session = str_sub(pw2015_t3_start$session,1,10)
pw2015_t3_singles$short_session = str_sub(pw2015_t3_singles$session,1,10)
pw2015_t3_relationship_number$short_session = str_sub(pw2015_t3_relationship_number$session,1,10)
#pw2015_t3_rate_partners$short_session = str_sub(pw2015_t3_rate_partners$session,1,10)
pw2015_t3_partners$short_session = str_sub(pw2015_t3_partners$session,1,10)
pw2015_t3_mainrelation$short_session = str_sub(pw2015_t3_mainrelation$session,1,10)
pw2015_t3_ende$short_session = str_sub(pw2015_t3_ende$session,1,10)
```


# Zusammenstellen der benötigten Variablen
# @ Charlotte: 
# Bitte für jedes Sheet, aus dem Daten benötigt werden, einzeln aufschreiben
# Die System- bzw. neu gebildeten Variablen Variablen "session", "short_session" und "ended" macht immer Sinn drin zu lassen
# Erstere werden für die Zuordnung gebraucht, letztere erlaubt es Abbrecher herauszunehmen
# Falls es in dem Sheet eine Variable gibt die "notes_to_us" oder "comment" heisst auch drin lassen
# Die brauchen wir später, um z.B. Fälle, bei denen es technische Probleme oder Verständnisschwierigkeiten
# gab, herauszufiltern

#t1
```{r}
pw2015_demographie_select <- pw2015_demographie %>%  select(
  session, short_session, 
  ended, 
  sex, 
  age,
  occupation,
  education,
  sex_orientation,
  attracted_to, # diese Variable muss attracted to heissen  
  NARQ_17,
  NARQ_7,
  NARQ_8,
  NARQ_11,
  NARQ_13,
  NARQ_6,
  NARQ_1,
  NARQ_18,
  NARQ_15,
  NARQ_16,
  NARQ_14,
  NARQ_9,
  NARQ_2,
  NARQ_10,
  NARQ_5,
  NARQ_12,
  NARQ_3,
  NARQ_4)

pw2015_items_select <- pw2015_items %>%  select(
  session, short_session, 
  ended, 
  global_interest_LT,
  global_interest_ST,
  SOI_R_5,     #Ich war mir unsicher, was wir bezüglich der folgenden Variablen vereinbart 
  longterm_1,  #hatten und habe mich erst mal dazu entschieden, sie mit aufzunehmen, 
  SOI_R_6R,    #falls ich für Sosziosexualität noch kontrollieren möchte.
  longterm_2_R,
  longterm_3_M,
  longterm_3_F,
  SOI_R_4,
  longterm_4_R_M,
  longterm_4_R_F,
  SOI_R_1,
  SOI_R_2,
  SOI_R_3,
  SOI_R_7,
  longterm_5_M,
  longterm_5_F,
  SOI_R_8,
  longterm_6_M,
  longterm_7_F,
  SOI_R_9,
  notes_to_us)
```


#t2
```{r}
pw2015_t2_select <- pw2015_t2 %>%  select( ## TMG: es gibt kein T2_items :(, Name geändert
  session, short_session, 
  ended, 
  relationship_m,
  relationship_m_multiple,
  relationship1_kind_m,
  relationship1_start_months_m,
  relationship1_start_weeks_m,
  relationship2_kind_m,
  relationship2_start_months_m,
  relationship2_start_weeks_m,
  relationship3_kind_m,
  relationship3_start_months_m,
  relationship3_start_weeks_m,
  pastrelationship1_m,
  pastrelationship1_kind_m,
  pastrelationship1_start_m,
  pastrelationship1_end_m,
  pastrelationship2_m,
  pastrelationship2_kind_m,
  pastrelationship2_start_m,
  pastrelationship2_end_m,
  pastrelationship3_m,
  pastrelationship3_kind_m,
  pastrelationship3_start_m,
  pastrelationship3_end_m,
  pastrelationship4_m,
  pastrelationship4_kind_m,
  pastrelationship4_start_m,
  pastrelationship4_end_m,
  pastrelationship5_m,
  pastrelationship5_kind_m,
  pastrelationship5_start_m,
  pastrelationship5_end_m,
  pastrelationship6_m,
  pastrelationshipmore_m)

pw2015_t2_frauen_select <- pw2015_t2_frauen %>%  select(
  session, short_session, 
  ended, 
  relationship_f,
  relationship_f_multiple,
  relationship1_kind_f,
  relationship1_start_months_f,
  relationship1_start_weeks_f,
  relationship2_kind_f,
  relationship2_start_months_f,
  relationship2_start_weeks_f,
  relationship3_kind_f,
  relationship3_start_months_f,
  relationship3_start_weeks_f,
  pastrelationship1_f,
  pastrelationship1_kind_f,
  pastrelationship1_start_f,
  pastrelationship1_end_f,
  pastrelationship2_f,
  pastrelationship2_kind_f,
  pastrelationship2_start_f,
  pastrelationship2_end_f,
  pastrelationship3_f,
  pastrelationship3_kind_f,
  pastrelationship3_start_f,
  pastrelationship3_end_f,
  pastrelationship4_f,
  pastrelationship4_kind_f,
  pastrelationship4_start_f,
  pastrelationship4_end_f,
  pastrelationship5_f,
  pastrelationship5_kind_f,
  pastrelationship5_start_f,
  pastrelationship5_end_f,
  pastrelationship6_f,
  pastrelationshipmore_f)


pw2015_t2_ende_select <- pw2015_t2_ende %>%  select(
  session, short_session, 
  ended, 
  notes_to_us_t2)
```



#t3
```{r}
pw2015_t3_start_select <- pw2015_t3_start %>%  select(
  session, short_session, 
  ended,
  F_self_t3_life_events,
  F_self_t3_life_event_other)

pw2015_t3_singles_select <- pw2015_t3_singles %>%  select(
  session, short_session, 
  ended,
  F_self_t3_interest_longterm_single_now, 
  F_self_t3_interest_longterm_single_now
#Das wäre vielleicht interessant, da man dafür kontrollieren könnte, ob Personen - 
#obwohl Single - Interesse an einer Langzeitbeziehung hätten.
)

pw2015_t3_relationship_number_select <- pw2015_t3_relationship_number %>%  select(
  session, short_session, 
  ended,
  F_t3_relationship_ultimate,
  F_t3_relationship
)

#pw2015_t3_rate_partners_select <- pw2015_t3_rate_partners %>%  select(
 # session, short_session, 
 # ended,
#

pw2015_t3_partners_select <- pw2015_t3_partners %>%  select(
  session, short_session, 
  ended,
  F_t3_start,
  F_t3_lasting,
  F_t3_end,
  F_t3_breakup,
  F_t3_kind,
  F_t3_past_kind,
  F_t3_closeup_kind
)
```

#Hier habe ich mir auch die Variablen rausgezogen, die ich am sinnvollsten fand. 
```{r}
pw2015_t3_mainrelation_select <- pw2015_t3_mainrelation %>%  select(
  session, short_session, 
  ended,
  F_self_t3_IMS_alternaavailab2,
  F_mate_t3_IMS_alternaavailab,
  F_self_t3_IMS_alternaavailab3,
  F_self_t3_IMS_commit1,
  F_self_t3_IMS_commit2,
  F_self_t3_IMS_commit3,
  F_self_t3_IMS_alternainterest1,
  F_self_t3_transgreact_forgive,
  F_self_t3_transgreact_yellat,
  F_self_t3_transgreact_revenge,
  F_self_t3_transgreact_getalong)

pw2015_t3_ende_select <- pw2015_t3_ende %>%  select(
  session, short_session, 
  ended,
  F_t3_honesty_check,
  F_t3_dishonest_answers,
  F_t3_notes_to_us)
```


# Abspeichern von Datenfiles
```{r}
write.csv2(pw2015_demographie_select, file = "pw2015_demographie_select.csv")
write.csv2(pw2015_items_select, file = "pw2015_items_select.csv")
write.csv2(pw2015_t2_select, file = "pw2015_t2_select.csv")
write.csv2(pw2015_t2_frauen_select, file = "pw2015_t2_frauen_select.csv")
write.csv2(pw2015_t2_ende_select, file = "pw2015_t2_ende_select.csv")
write.csv2(pw2015_t3_start_select, file = "pw2015_t3_start _select.csv")
write.csv2(pw2015_t3_singles_select, file = "pw2015_t3_singles_select.csv")
write.csv2(pw2015_t3_relationship_number_select, file = "pw2015_t3_relationship_number_select.csv")
#write.csv2(pw2015_t3_rate_partners_select, file = "pw2015_t3_rate_partners_select.csv")
write.csv2(pw2015_t3_partners_select, file = "pw2015_t3_partners_select.csv")
write.csv2(pw2015_t3_mainrelation_select, file = "pw2015_t3_mainrelation_select.csv")
write.csv2(pw2015_t3_ende_select, file = "pw2015_t3_ende_select.csv")
```



# TMG: 
# OKAY, alles durchgelaufen
# Geteilter Ordner?